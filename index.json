[{"authors":null,"categories":null,"content":"I am a brazilian geographer looking foward to adress environmental challenges with geographical data science, taking the power of earth observation data, spatial statistics and software development.\nHow did I get here? While working with the assessment of the brazilian\u0026rsquo;s flora conservation status, I realized that, by that time, there was a lot to do and a few human resources. So, I decided to do a specialization in spatial statistics looking foward for tools that could help the assessment optimization. I ended with a statistical approach to estimated the exposure of floras' species over fire, one of the most known proxy of environmental degradation. If you are interested, the final paper is available here (pt-br).\nIn my master project I have worked with spatial priorization to make conservation and mineral exploration compatible on an Environmental Reserve in the Amazon forest. You can read more about this experience here or access the book with all project details (both in pt-br).\nIn the last few years I have been working with an international scientific group on reasearches developing algorithms and identifying priority areas for landscape restoration. This work resulted in the publication of several scientific publications.\n","date":-62135596800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":-62135596800,"objectID":"26f7143ab6a67e9866e2f9d6bd18a253","permalink":"/author/felipe-sodre-mendes-barros/","publishdate":"0001-01-01T00:00:00Z","relpermalink":"/author/felipe-sodre-mendes-barros/","section":"authors","summary":"I am a brazilian geographer looking foward to adress environmental challenges with geographical data science, taking the power of earth observation data, spatial statistics and software development.\nHow did I get here?","tags":null,"title":"Felipe Sodr√© Mendes Barros","type":"authors"},{"authors":null,"categories":null,"content":"Flexibility This feature can be used for publishing content such as:\n Online courses Project or software documentation Tutorials  The courses folder may be renamed. For example, we can rename it to docs for software/project documentation or tutorials for creating an online course.\nDelete tutorials To remove these pages, delete the courses folder and see below to delete the associated menu link.\nUpdate site menu After renaming or deleting the courses folder, you may wish to update any [[main]] menu links to it by editing your menu configuration at config/_default/menus.toml.\nFor example, if you delete this folder, you can remove the following from your menu configuration:\n[[main]] name = \u0026quot;Courses\u0026quot; url = \u0026quot;courses/\u0026quot; weight = 50  Or, if you are creating a software documentation site, you can rename the courses folder to docs and update the associated Courses menu configuration to:\n[[main]] name = \u0026quot;Docs\u0026quot; url = \u0026quot;docs/\u0026quot; weight = 50  Update the docs menu If you use the docs layout, note that the name of the menu in the front matter should be in the form [menu.X] where X is the folder name. Hence, if you rename the courses/example/ folder, you should also rename the menu definitions in the front matter of files within courses/example/ from [menu.example] to [menu.\u0026lt;NewFolderName\u0026gt;].\n","date":1536451200,"expirydate":-62135596800,"kind":"section","lang":"en","lastmod":1536451200,"objectID":"59c3ce8e202293146a8a934d37a4070b","permalink":"/courses/example/","publishdate":"2018-09-09T00:00:00Z","relpermalink":"/courses/example/","section":"courses","summary":"Learn how to use Academic's docs layout for publishing online courses, software documentation, and tutorials.","tags":null,"title":"Overview","type":"docs"},{"authors":null,"categories":null,"content":"In this tutorial, I\u0026rsquo;ll share my top 10 tips for getting started with Academic:\nTip 1 Lorem ipsum dolor sit amet, consectetur adipiscing elit. Duis posuere tellus ac convallis placerat. Proin tincidunt magna sed ex sollicitudin condimentum. Sed ac faucibus dolor, scelerisque sollicitudin nisi. Cras purus urna, suscipit quis sapien eu, pulvinar tempor diam. Quisque risus orci, mollis id ante sit amet, gravida egestas nisl. Sed ac tempus magna. Proin in dui enim. Donec condimentum, sem id dapibus fringilla, tellus enim condimentum arcu, nec volutpat est felis vel metus. Vestibulum sit amet erat at nulla eleifend gravida.\nNullam vel molestie justo. Curabitur vitae efficitur leo. In hac habitasse platea dictumst. Sed pulvinar mauris dui, eget varius purus congue ac. Nulla euismod, lorem vel elementum dapibus, nunc justo porta mi, sed tempus est est vel tellus. Nam et enim eleifend, laoreet sem sit amet, elementum sem. Morbi ut leo congue, maximus velit ut, finibus arcu. In et libero cursus, rutrum risus non, molestie leo. Nullam congue quam et volutpat malesuada. Sed risus tortor, pulvinar et dictum nec, sodales non mi. Phasellus lacinia commodo laoreet. Nam mollis, erat in feugiat consectetur, purus eros egestas tellus, in auctor urna odio at nibh. Mauris imperdiet nisi ac magna convallis, at rhoncus ligula cursus.\nCras aliquam rhoncus ipsum, in hendrerit nunc mattis vitae. Duis vitae efficitur metus, ac tempus leo. Cras nec fringilla lacus. Quisque sit amet risus at ipsum pharetra commodo. Sed aliquam mauris at consequat eleifend. Praesent porta, augue sed viverra bibendum, neque ante euismod ante, in vehicula justo lorem ac eros. Suspendisse augue libero, venenatis eget tincidunt ut, malesuada at lorem. Donec vitae bibendum arcu. Aenean maximus nulla non pretium iaculis. Quisque imperdiet, nulla in pulvinar aliquet, velit quam ultrices quam, sit amet fringilla leo sem vel nunc. Mauris in lacinia lacus.\nSuspendisse a tincidunt lacus. Curabitur at urna sagittis, dictum ante sit amet, euismod magna. Sed rutrum massa id tortor commodo, vitae elementum turpis tempus. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aenean purus turpis, venenatis a ullamcorper nec, tincidunt et massa. Integer posuere quam rutrum arcu vehicula imperdiet. Mauris ullamcorper quam vitae purus congue, quis euismod magna eleifend. Vestibulum semper vel augue eget tincidunt. Fusce eget justo sodales, dapibus odio eu, ultrices lorem. Duis condimentum lorem id eros commodo, in facilisis mauris scelerisque. Morbi sed auctor leo. Nullam volutpat a lacus quis pharetra. Nulla congue rutrum magna a ornare.\nAliquam in turpis accumsan, malesuada nibh ut, hendrerit justo. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Quisque sed erat nec justo posuere suscipit. Donec ut efficitur arcu, in malesuada neque. Nunc dignissim nisl massa, id vulputate nunc pretium nec. Quisque eget urna in risus suscipit ultricies. Pellentesque odio odio, tincidunt in eleifend sed, posuere a diam. Nam gravida nisl convallis semper elementum. Morbi vitae felis faucibus, vulputate orci placerat, aliquet nisi. Aliquam erat volutpat. Maecenas sagittis pulvinar purus, sed porta quam laoreet at.\nTip 2 Lorem ipsum dolor sit amet, consectetur adipiscing elit. Duis posuere tellus ac convallis placerat. Proin tincidunt magna sed ex sollicitudin condimentum. Sed ac faucibus dolor, scelerisque sollicitudin nisi. Cras purus urna, suscipit quis sapien eu, pulvinar tempor diam. Quisque risus orci, mollis id ante sit amet, gravida egestas nisl. Sed ac tempus magna. Proin in dui enim. Donec condimentum, sem id dapibus fringilla, tellus enim condimentum arcu, nec volutpat est felis vel metus. Vestibulum sit amet erat at nulla eleifend gravida.\nNullam vel molestie justo. Curabitur vitae efficitur leo. In hac habitasse platea dictumst. Sed pulvinar mauris dui, eget varius purus congue ac. Nulla euismod, lorem vel elementum dapibus, nunc justo porta mi, sed tempus est est vel tellus. Nam et enim eleifend, laoreet sem sit amet, elementum sem. Morbi ut leo congue, maximus velit ut, finibus arcu. In et libero cursus, rutrum risus non, molestie leo. Nullam congue quam et volutpat malesuada. Sed risus tortor, pulvinar et dictum nec, sodales non mi. Phasellus lacinia commodo laoreet. Nam mollis, erat in feugiat consectetur, purus eros egestas tellus, in auctor urna odio at nibh. Mauris imperdiet nisi ac magna convallis, at rhoncus ligula cursus.\nCras aliquam rhoncus ipsum, in hendrerit nunc mattis vitae. Duis vitae efficitur metus, ac tempus leo. Cras nec fringilla lacus. Quisque sit amet risus at ipsum pharetra commodo. Sed aliquam mauris at consequat eleifend. Praesent porta, augue sed viverra bibendum, neque ante euismod ante, in vehicula justo lorem ac eros. Suspendisse augue libero, venenatis eget tincidunt ut, malesuada at lorem. Donec vitae bibendum arcu. Aenean maximus nulla non pretium iaculis. Quisque imperdiet, nulla in pulvinar aliquet, velit quam ultrices quam, sit amet fringilla leo sem vel nunc. Mauris in lacinia lacus.\nSuspendisse a tincidunt lacus. Curabitur at urna sagittis, dictum ante sit amet, euismod magna. Sed rutrum massa id tortor commodo, vitae elementum turpis tempus. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aenean purus turpis, venenatis a ullamcorper nec, tincidunt et massa. Integer posuere quam rutrum arcu vehicula imperdiet. Mauris ullamcorper quam vitae purus congue, quis euismod magna eleifend. Vestibulum semper vel augue eget tincidunt. Fusce eget justo sodales, dapibus odio eu, ultrices lorem. Duis condimentum lorem id eros commodo, in facilisis mauris scelerisque. Morbi sed auctor leo. Nullam volutpat a lacus quis pharetra. Nulla congue rutrum magna a ornare.\nAliquam in turpis accumsan, malesuada nibh ut, hendrerit justo. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Quisque sed erat nec justo posuere suscipit. Donec ut efficitur arcu, in malesuada neque. Nunc dignissim nisl massa, id vulputate nunc pretium nec. Quisque eget urna in risus suscipit ultricies. Pellentesque odio odio, tincidunt in eleifend sed, posuere a diam. Nam gravida nisl convallis semper elementum. Morbi vitae felis faucibus, vulputate orci placerat, aliquet nisi. Aliquam erat volutpat. Maecenas sagittis pulvinar purus, sed porta quam laoreet at.\n","date":1557010800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1557010800,"objectID":"74533bae41439377bd30f645c4677a27","permalink":"/courses/example/example1/","publishdate":"2019-05-05T00:00:00+01:00","relpermalink":"/courses/example/example1/","section":"courses","summary":"In this tutorial, I\u0026rsquo;ll share my top 10 tips for getting started with Academic:\nTip 1 Lorem ipsum dolor sit amet, consectetur adipiscing elit. Duis posuere tellus ac convallis placerat. Proin tincidunt magna sed ex sollicitudin condimentum.","tags":null,"title":"Example Page 1","type":"docs"},{"authors":null,"categories":null,"content":"Here are some more tips for getting started with Academic:\nTip 3 Lorem ipsum dolor sit amet, consectetur adipiscing elit. Duis posuere tellus ac convallis placerat. Proin tincidunt magna sed ex sollicitudin condimentum. Sed ac faucibus dolor, scelerisque sollicitudin nisi. Cras purus urna, suscipit quis sapien eu, pulvinar tempor diam. Quisque risus orci, mollis id ante sit amet, gravida egestas nisl. Sed ac tempus magna. Proin in dui enim. Donec condimentum, sem id dapibus fringilla, tellus enim condimentum arcu, nec volutpat est felis vel metus. Vestibulum sit amet erat at nulla eleifend gravida.\nNullam vel molestie justo. Curabitur vitae efficitur leo. In hac habitasse platea dictumst. Sed pulvinar mauris dui, eget varius purus congue ac. Nulla euismod, lorem vel elementum dapibus, nunc justo porta mi, sed tempus est est vel tellus. Nam et enim eleifend, laoreet sem sit amet, elementum sem. Morbi ut leo congue, maximus velit ut, finibus arcu. In et libero cursus, rutrum risus non, molestie leo. Nullam congue quam et volutpat malesuada. Sed risus tortor, pulvinar et dictum nec, sodales non mi. Phasellus lacinia commodo laoreet. Nam mollis, erat in feugiat consectetur, purus eros egestas tellus, in auctor urna odio at nibh. Mauris imperdiet nisi ac magna convallis, at rhoncus ligula cursus.\nCras aliquam rhoncus ipsum, in hendrerit nunc mattis vitae. Duis vitae efficitur metus, ac tempus leo. Cras nec fringilla lacus. Quisque sit amet risus at ipsum pharetra commodo. Sed aliquam mauris at consequat eleifend. Praesent porta, augue sed viverra bibendum, neque ante euismod ante, in vehicula justo lorem ac eros. Suspendisse augue libero, venenatis eget tincidunt ut, malesuada at lorem. Donec vitae bibendum arcu. Aenean maximus nulla non pretium iaculis. Quisque imperdiet, nulla in pulvinar aliquet, velit quam ultrices quam, sit amet fringilla leo sem vel nunc. Mauris in lacinia lacus.\nSuspendisse a tincidunt lacus. Curabitur at urna sagittis, dictum ante sit amet, euismod magna. Sed rutrum massa id tortor commodo, vitae elementum turpis tempus. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aenean purus turpis, venenatis a ullamcorper nec, tincidunt et massa. Integer posuere quam rutrum arcu vehicula imperdiet. Mauris ullamcorper quam vitae purus congue, quis euismod magna eleifend. Vestibulum semper vel augue eget tincidunt. Fusce eget justo sodales, dapibus odio eu, ultrices lorem. Duis condimentum lorem id eros commodo, in facilisis mauris scelerisque. Morbi sed auctor leo. Nullam volutpat a lacus quis pharetra. Nulla congue rutrum magna a ornare.\nAliquam in turpis accumsan, malesuada nibh ut, hendrerit justo. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Quisque sed erat nec justo posuere suscipit. Donec ut efficitur arcu, in malesuada neque. Nunc dignissim nisl massa, id vulputate nunc pretium nec. Quisque eget urna in risus suscipit ultricies. Pellentesque odio odio, tincidunt in eleifend sed, posuere a diam. Nam gravida nisl convallis semper elementum. Morbi vitae felis faucibus, vulputate orci placerat, aliquet nisi. Aliquam erat volutpat. Maecenas sagittis pulvinar purus, sed porta quam laoreet at.\nTip 4 Lorem ipsum dolor sit amet, consectetur adipiscing elit. Duis posuere tellus ac convallis placerat. Proin tincidunt magna sed ex sollicitudin condimentum. Sed ac faucibus dolor, scelerisque sollicitudin nisi. Cras purus urna, suscipit quis sapien eu, pulvinar tempor diam. Quisque risus orci, mollis id ante sit amet, gravida egestas nisl. Sed ac tempus magna. Proin in dui enim. Donec condimentum, sem id dapibus fringilla, tellus enim condimentum arcu, nec volutpat est felis vel metus. Vestibulum sit amet erat at nulla eleifend gravida.\nNullam vel molestie justo. Curabitur vitae efficitur leo. In hac habitasse platea dictumst. Sed pulvinar mauris dui, eget varius purus congue ac. Nulla euismod, lorem vel elementum dapibus, nunc justo porta mi, sed tempus est est vel tellus. Nam et enim eleifend, laoreet sem sit amet, elementum sem. Morbi ut leo congue, maximus velit ut, finibus arcu. In et libero cursus, rutrum risus non, molestie leo. Nullam congue quam et volutpat malesuada. Sed risus tortor, pulvinar et dictum nec, sodales non mi. Phasellus lacinia commodo laoreet. Nam mollis, erat in feugiat consectetur, purus eros egestas tellus, in auctor urna odio at nibh. Mauris imperdiet nisi ac magna convallis, at rhoncus ligula cursus.\nCras aliquam rhoncus ipsum, in hendrerit nunc mattis vitae. Duis vitae efficitur metus, ac tempus leo. Cras nec fringilla lacus. Quisque sit amet risus at ipsum pharetra commodo. Sed aliquam mauris at consequat eleifend. Praesent porta, augue sed viverra bibendum, neque ante euismod ante, in vehicula justo lorem ac eros. Suspendisse augue libero, venenatis eget tincidunt ut, malesuada at lorem. Donec vitae bibendum arcu. Aenean maximus nulla non pretium iaculis. Quisque imperdiet, nulla in pulvinar aliquet, velit quam ultrices quam, sit amet fringilla leo sem vel nunc. Mauris in lacinia lacus.\nSuspendisse a tincidunt lacus. Curabitur at urna sagittis, dictum ante sit amet, euismod magna. Sed rutrum massa id tortor commodo, vitae elementum turpis tempus. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aenean purus turpis, venenatis a ullamcorper nec, tincidunt et massa. Integer posuere quam rutrum arcu vehicula imperdiet. Mauris ullamcorper quam vitae purus congue, quis euismod magna eleifend. Vestibulum semper vel augue eget tincidunt. Fusce eget justo sodales, dapibus odio eu, ultrices lorem. Duis condimentum lorem id eros commodo, in facilisis mauris scelerisque. Morbi sed auctor leo. Nullam volutpat a lacus quis pharetra. Nulla congue rutrum magna a ornare.\nAliquam in turpis accumsan, malesuada nibh ut, hendrerit justo. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Quisque sed erat nec justo posuere suscipit. Donec ut efficitur arcu, in malesuada neque. Nunc dignissim nisl massa, id vulputate nunc pretium nec. Quisque eget urna in risus suscipit ultricies. Pellentesque odio odio, tincidunt in eleifend sed, posuere a diam. Nam gravida nisl convallis semper elementum. Morbi vitae felis faucibus, vulputate orci placerat, aliquet nisi. Aliquam erat volutpat. Maecenas sagittis pulvinar purus, sed porta quam laoreet at.\n","date":1557010800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1557010800,"objectID":"1c2b5a11257c768c90d5050637d77d6a","permalink":"/courses/example/example2/","publishdate":"2019-05-05T00:00:00+01:00","relpermalink":"/courses/example/example2/","section":"courses","summary":"Here are some more tips for getting started with Academic:\nTip 3 Lorem ipsum dolor sit amet, consectetur adipiscing elit. Duis posuere tellus ac convallis placerat. Proin tincidunt magna sed ex sollicitudin condimentum.","tags":null,"title":"Example Page 2","type":"docs"},{"authors":["Felipe"],"categories":null,"content":" Click on the Slides button above to view the built-in slides feature.   Slides can be added in a few ways:\n Create slides using Wowchemy\u0026rsquo;s Slides feature and link using slides parameter in the front matter of the talk file Upload an existing slide deck to static/ and link using url_slides parameter in the front matter of the talk file Embed your slides (e.g. Google Slides) or presentation video on this page using shortcodes.  Further event details, including page elements such as image galleries, can be added to the body of this page.\n","date":1906549200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1906549200,"objectID":"a8edef490afe42206247b6ac05657af0","permalink":"/talk/example-talk/","publishdate":"2017-01-01T00:00:00Z","relpermalink":"/talk/example-talk/","section":"event","summary":"An example talk using Wowchemy's Markdown slides feature.","tags":[],"title":"Example Talk","type":"event"},{"authors":[],"categories":["Python"],"content":"Caso n√£o tenha visto as publica√ß√µes anteriores, deixo aqui o link e os temas abordados:\n Na primeira publica√ß√£o falo sobre o django-geojson para simular um campo geogr√°fico no models; o geojson para criar um objeto da classe geojson e realizar as valida√ß√µes necess√°rias para garantir robustez do sistema, e a cria√ß√£o do formul√°rio de registro de dados usando o ModelForm; Na segunda publica√ß√£o apresento os validadores de campo do Django como uma ferramenta fundamental na qualidade dos dados espaciais, sem depender de infraestrutura SIG (GIS).  Agora a ideia √© implementar um webmap usando o m√≥dulo django-leaflet para apresentar os fen√¥menos mapeados com algumas informa√ß√µes no popup do mapa. Para isso iremos:\n usar o GeoJSONLayerView, do django-geojson para retornar os dados salvos no formato apropriado para exibi√ß√£o no webmap; usar o django-leaflet para, al√©m de implementar o webmap, podermos usar v√°rias outras ferramentas (widget);  Vamos l√°!\nView GeoJSONLayerView A serializa√ß√£o ou, em ingl√™s serialization, √© o processo/mecanismo de tradu√ß√£o dos objetos armazenados na base de dados em outros formatos (em geral, baseado em texto como, por exemplo, XML ou JSON), para serem enviados e/ou consumidos no processo de request/response.\nNo nosso caso isso ser√° importante, pois para apresentar os dados salvos em um webmap, precisaremos servi-los no formato geojson. E √© a√≠ que o django-geojson entra. N√≥s o utilizaremos para fazer a m√°gica acontecer ao usar a classe GeoJSONLayerView.\nA classe GeoJSONLayerView √© um mixin que, em base ao modelo informado do nosso projeto, serializa os dados transformando-os em geojson e os servindo em uma view. Acredite, √© bastante coisa para apenas algumas linhas de c√≥digo.\nPara entender a serializa√ß√£o, segue um exemplo\u0026hellip;\nAo acessar os dados do banco de dados do nosso projeto, temos uma QuerySet.\n\u0026gt;\u0026gt;\u0026gt; Fenomeno.objects.all() \u0026lt;QuerySet [\u0026lt;Fenomeno: fenomeno_teste\u0026gt;]\u0026gt;  Ao acessar a geometria de um objeto do banco de dados do nosso projeto, temos um geojson.\n\u0026gt;\u0026gt;\u0026gt; Fenomeno.objects.get(pk=3).geom {'type': 'Point', 'coordinates': [-42.0, -22.0]}  Ao serializ√°-lo com o GeoJSONSerializer, temos como retorno uma FeatureCollection seguindo o formato geojson, tendo como propriedades os campos do model:\n\u0026gt;\u0026gt;\u0026gt; from djgeojson.serializers import Serializer as GeoJSONSerializer \u0026gt;\u0026gt;\u0026gt; GeoJSONSerializer().serialize(Fenomeno.objects.all(), use_natural_keys=True, with_modelname=False) '{'crs': {'properties': {'href': 'http://spatialreference.org/ref/epsg/4326/', 'type': 'proj4'}, 'type': 'link'}, 'features': [{'geometry': {'coordinates': [-42.0, -22.0], 'type': 'Point'}, 'id': 3, 'properties': {'data': '2021-06-22', 'hora': '02:07:57', 'nome': 'teste'}, 'type': 'Feature'}], 'type': 'FeatureCollection'}'  Mais sobre serializa√ß√£o pode ser encontrado aqui ou aqui, com outro exemplo relacionado a dado geogr√°fico usando o GeoDjango.\nEnt√£o, ciente de toda a m√°gica por tr√°s do GeoJSONLayerView e o seu resultado, vamos criar os testes para essa view.\nCriando os testes da view Como estou testando justamente uma view que serializa o objeto do meu modelo em formato geojson, precisarei desses dados salvos no banco de dados. Para tanto, vou adicionar ao setUp do meu TestCase valores v√°lidos ao banco de dados do teste. Sem isso, n√£o poderemos confirmar se a serializa√ß√£o est√° ocorrendo de forma correta. E, uma vez salvo, realizo um conjunto b√°sico de testes:\n  Confirmo se o status code do request (m√©todo \u0026ldquo;get\u0026rdquo;) ao path que pretendo usar para essa views (no caso, \u0026ldquo;/geojson/\u0026quot;), retorna 200, c√≥digo que indica sucesso no processo de request/response. Veja mais sobre os c√≥digos aqui.\n  Em seguida, confirmo se a resposta recebida √© uma FetureCollection com os dados da inst√¢ncia criada anteriormente.\n  # testes.py class FenomenoGeoJsonTest(TestCase): def setUp(self): Fenomeno.objects.create( nome=\u0026quot;Teste\u0026quot;, data=\u0026quot;2020-01-01\u0026quot;, hora=\u0026quot;09:12:12\u0026quot;, geom={\u0026quot;type\u0026quot;: \u0026quot;Point\u0026quot;, \u0026quot;coordinates\u0026quot;: [-42, -22]}, ) def teste_geojson_status_code(self): self.resp = self.client.get(r(\u0026quot;geojson\u0026quot;)) self.assertEqual(200, self.resp.status_code) def teste_path_geojson_returns_valid_feature_collection(self): self.resp = self.client.get(r(\u0026quot;geojson\u0026quot;)) self.assertEqual( self.resp.json(), { \u0026quot;type\u0026quot;: \u0026quot;FeatureCollection\u0026quot;, \u0026quot;features\u0026quot;: [ { \u0026quot;type\u0026quot;: \u0026quot;Feature\u0026quot;, \u0026quot;properties\u0026quot;: { \u0026quot;popup_content\u0026quot;: \u0026quot;\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;span\u0026gt;Nome: \u0026lt;/span\u0026gt;Teste\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\u0026quot;, \u0026quot;model\u0026quot;: \u0026quot;core.fenomeno\u0026quot;, }, \u0026quot;id\u0026quot;: 1, \u0026quot;geometry\u0026quot;: {\u0026quot;type\u0026quot;: \u0026quot;Point\u0026quot;, \u0026quot;coordinates\u0026quot;: [-42.0, -22.0]}, } ], \u0026quot;crs\u0026quot;: {\u0026quot;type\u0026quot;: \u0026quot;name\u0026quot;, \u0026quot;properties\u0026quot;: {\u0026quot;name\u0026quot;: \u0026quot;EPSG:4326\u0026quot;}}, }, )  Obviamente, ambos testes falhar√£o, pois, ainda n√£o criamos a view e nem a designamos a um path do nosso sistema.\nPara faz√™-los passar, vamos primeiro criar a view: Em views.py criaremos uma classe nova, herdando da classe GeoJSONLayerView. Ela ser√° a view respons√°vel por resgatar os dados e servir-nos como uma FeatureCollection seguindo a estrutura de um geojson.\nUm √∫ltimo detalhe √© que, como estamos usando um Class Based-View, ao final a convertemos em view, com o m√©todo as_view().\n# views.py from djgeojson.views import GeoJSONLayerView from map_proj.core.models import Fenomeno class FenomenoGeoJson(GeoJSONLayerView): model = Fenomeno properties = (\u0026quot;popup_content\u0026quot;,) fenomeno_geojson = FenomenoGeoJson.as_view()  Adicionando propriedade para popup Percebam que no teste_geojson_FeatureCollection eu j√° estou considerando que o geojson vir√° com properties com o nome de popup-content. Essa property ainda dever√° ser criada no model em quest√£o e poder√° ter quantas informa√ß√µes acharmos pertinentes. Se tratam das informa√ß√µes do model a serem apresentadas no popup do mapa.\nPor agora estou apenas informando o nome do fen√¥meno mapeado mas, mais √† frente, podemos incrementar, adicionando um get_absolute_url por exemplo, para poder acessar aos detalhes do fen√¥meno diretamente a partir do popup do mapa.\n#models.py ... @property def popup_content(self): return self.nome  Adicionando um path a view Para poder acessar essa view, precisamos incorpor√°-la na nossa urls.py:\n# urls.py from django.contrib import admin from django.urls import path from map_proj.core.views import fenomeno_geojson # novo! urlpatterns = [ path(\u0026quot;admin/\u0026quot;, admin.site.urls), path(\u0026quot;geojson/\u0026quot;, fenomeno_geojson, name=\u0026quot;geojson\u0026quot;), # novo! ]  Com isso teremos os nossos √∫ltimos testes passando. Se ainda assim voc√™ tiver curiosidade, pode executar o runserver e acessar os dados pela url http://127.0.0.1:8000/geojson/. O resultado esperado s√£o os dados servidos em geojson:\n{ \u0026quot;type\u0026quot;: \u0026quot;FeatureCollection\u0026quot;, \u0026quot;features\u0026quot;: [ { \u0026quot;type\u0026quot;: \u0026quot;Feature\u0026quot;, \u0026quot;properties\u0026quot;: { \u0026quot;popup_content\u0026quot;: \u0026quot;\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;span\u0026gt;Nome: \u0026lt;/span\u0026gt;Teste\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\u0026quot;, \u0026quot;model\u0026quot;: \u0026quot;core.fenomeno\u0026quot;, }, \u0026quot;id\u0026quot;: 1, \u0026quot;geometry\u0026quot;: {\u0026quot;type\u0026quot;: \u0026quot;Point\u0026quot;, \u0026quot;coordinates\u0026quot;: [-42.0, -22.0]}, } ], \u0026quot;crs\u0026quot;: {\u0026quot;type\u0026quot;: \u0026quot;name\u0026quot;, \u0026quot;properties\u0026quot;: {\u0026quot;name\u0026quot;: \u0026quot;EPSG:4326\u0026quot;}}, }  ‚ö†Ô∏è Garanta que voc√™ j√° tenha inserido algum dado ao seu projeto ;)\nPronto, j√° temos uma view nos servindo os dados em formato geojson. Vamos ao Django-leaflet, para entender como montar um webmap.\nDjango-leaflet Para saber mais sobre o django-leaflet, recomendo dar uma olhada na p√°gina pypi e na documenta√ß√£o.\nVoc√™ deve estar se perguntando: \u0026ldquo;por qu√™ usar o django-leaflet se eu posso usar o leaflet \u0026ldquo;puro\u0026rdquo;, j√° que se trata de uma biblioteca JavaScript para produ√ß√£o do mapa no frontend?\u0026rdquo;.\nOs autores do projeto django-leaflet deixam alguns pontos que justificam sua ado√ß√£o na p√°gina da documenta√ß√£o. Das quais eu destaco:\n Possibilidade de uso das ferramentas de edi√ß√£o de geometr√≠a usando os widget; F√°cil integra√ß√£o dos widgets na p√°gina admin do Django; Controle da apar√™ncia dos mapas a partir do Django settings.py;  ‚ö†Ô∏è E por √∫ltimo, mas n√£o menos importante:\n django-leaflet √© compat√≠vel com os campos django-geojson, o que permite o uso de dados geogr√°ficos sem a necessidade de uma base de dados espaciais. O motivo de toda essa s√©rie que tenho produzido :)\n Bem legal! Eles criaram um pacote j√° compat√≠vel com o pacote django-geojson, que nos permite simular campos geogr√°ficos sem a necessidade de toda a infraestrutura de uma base de dados de SIG (PostGIS, por exemplo).\n‚ö†Ô∏è Por√©m, aten√ß√£o ao seguinte detalhe:+\n O django-leaflet depende da biblioteca GDAL, n√£o se esque√ßa de instal√°-la antes.\n Instalando django-leaflet pip install django-leaflet  Ap√≥s a sua instala√ß√£o √© necess√°rio inclu√≠-lo no settings.py como INSTALLED_APPS.\n‚ö†Ô∏è N√£o esque√ßa de adicion√°-lo ao requirements.txt do projeto, tamb√©m.\n# settings.py INSTALLED_APPS = [ ... 'djgeojson', 'leaflet', # novo ... ]  Usando o leaflet Com leaflet instalado, devemos ent√£o:\n Na pasta da nossa app, vamos criar uma pasta chamada \u0026ldquo;templates\u0026rdquo;; E nessa pasta, criar um arquivo HTML (neste caso vou chamar de \u0026ldquo;map.html\u0026rdquo;; Nessa p√°gina vamos carregar as template_tags do leaflet para poder usar leaflet_js, leaflet_css e o leaflet_map:  Nosso map.html:\n{% load leaflet_tags %} \u0026lt;head\u0026gt; ... {% leaflet_js %} {% leaflet_css %} \u0026lt;/head\u0026gt; ... \u0026lt;body\u0026gt; ... {% leaflet_map \u0026quot;yourmap\u0026quot; %} ... \u0026lt;/body\u0026gt;  Essas template_tags ir√£o tentar acessar as configura√ß√µes do leaflet presentes no settings.py da app, caso existam. Do contr√°rio, ser√£o usados valores padr√£o de configura√ß√£o. O interessante dessas template_tags √© que com elas podemos customizar tais configura√ß√µes a cada template;\nComo a ideia √© apenas renderizar essa p√°gina, vou adicionar ao urls.py um path a ela, usando o TemplateView. Com isso, ao receber um request neste path, a responsta ser√° direcionada √† renderiza√ß√£o dessa p√°gina:  #urls.py from django.contrib import admin from django.urls import path from django.views.generic import TemplateView from map_proj.core.views import fenomeno_geojson urlpatterns = [ path(\u0026quot;admin/\u0026quot;, admin.site.urls), path(\u0026quot;geojson/\u0026quot;, fenomeno_geojson, name=\u0026quot;geojson\u0026quot;), path(\u0026quot;map/\u0026quot;, TemplateView.as_view(template_name=\u0026quot;map.html\u0026quot;), name=\u0026quot;map\u0026quot;), ]  Isso j√° o suficiente para termos nosso webmap apresentado:\nImagino que n√£o seja o que esperava, n√©? Fique calmo. O leaflet buscou as configura√ß√µes do mapa e, como n√£o encontrou, retornou o mesmo com as configura√ß√µes padr√£o. Veremos em breve como alterar as configura√ß√µes do mapa.\nAntes disso, vamos \u0026ldquo;linkar\u0026rdquo; a view que nos serve o geojson com os dados salvos no banco com o webmap em quest√£o, para que os dados sejam apresentados.\nRenderizando o geojson no mapa Lembra que temos uma view que serializa os dados armazenados no banco e nos serve como uma FeatureCollection e que podemos acessar tais dados pelo path geojson/?\nEnt√£o, iremos adicionar um script √† nossa p√°gina no qual uma vari√°vel dataurl receber√° os dados dessa url adicionando tais dados ao mapa, assim que o mesmo for inicializado, desencadeando o processo de constru√ß√£o da popup de cada fei√ß√£o apresentada com sua posterior inser√ß√£o ao mapa:\n{% load leaflet_tags %} \u0026lt;script\u0026gt; var dataurl = '{% url \u0026quot;geojson\u0026quot; %}'; window.addEventListener(\u0026quot;map:init\u0026quot;, function (event) { var map = event.detail.map; // Download GeoJSON data with Ajax fetch(dataurl) .then(function(resp) { return resp.json(); }) .then(function(data) { L.geoJson(data, { onEachFeature: function onEachFeature(feature, layer) { var props = \u0026quot;\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;span\u0026gt;Nome: \u0026lt;/span\u0026gt; \u0026quot; + feature.properties.popup_content + \u0026quot;\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\u0026quot;; layer.bindPopup(props); }}).addTo(map); }); }); \u0026lt;/script\u0026gt; \u0026lt;head\u0026gt; {% leaflet_js %} {% leaflet_css %} \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; {% leaflet_map \u0026quot;yourmap\u0026quot; %} \u0026lt;/body\u0026gt;  Veja que, para a cria√ß√£o da vari√°vel dataurl, estamos usando a template_tag do django: var dataurl = '{% url \u0026quot;geojson\u0026quot; %}';\nVeja mais sobre ela aqui.\nRepare tamb√©m que, neste processo, a cada Feature, ser√° carregada as suas propriedades a serem apresentadas no popup:\nL.geoJson(data, { onEachFeature: function onEachFeature(feature, layer) { var props = \u0026quot;\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;span\u0026gt;Nome: \u0026lt;/span\u0026gt; \u0026quot; + feature.properties.popup_content + \u0026quot;\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\u0026quot;; layer.bindPopup(props); }}).addTo(map);  Com o runserver em execu√ß√£o, j√° poderemos ver o nosso mapa com o dado carregado e as propriedades que definimos no popup:\n‚ö†Ô∏è Garanta que voc√™ j√° tenha inserido algum dado ao seu projeto ;)\nMudando o tamanho do webmap:\nAntes de passarmos √†s configura√ß√µes do leaflet, podemos alterar as dimens√µes do mapa definindo um style. Por exemplo, para que o mapa ocupe toda a √°rea poss√≠vel do navegador, basta adicionarmos:\n\u0026lt;style\u0026gt; #yourmap { width: 100%; height: 100%; } \u0026lt;/style\u0026gt;  Configura√ß√µes do leaflet Bom, al√©m das template_tags do leaflet, o uso do django-leaflet nos permite definirmos as suas configura√ß√µes no settings.py da app, a partir da se√ß√£o LEAFLET_CONFIG.\nDentre as configura√ß√µes poss√≠veis , vou usar apenas o par de coordenadas ao qual o mapa dever√° estar centralizado por padr√£o (DEFAULT_CENTER) e o zoom padr√£o (DEFAULT_ZOOM):\nLEAFLET_CONFIG = { 'DEFAULT_CENTER': (-22, -42), 'DEFAULT_ZOOM': 7, }  Com isso nosso mapa sempre ser√° apresentado centralizado nas coordenadas (-22, -42) e com o zoom 7:\nPronto: com esses tr√™s artigos, j√° temos um sistema com formul√°rio de inser√ß√£o de dados, com as devidas valida√ß√µes dos dados preenchidos no mesmo, assim como um webmap apresentando-os ao mundo :-).\nNa pr√≥xima publica√ß√£o vamos ver como fazer o deploy desse sistema no heroku üöÄ.\nAt√© l√°!\n","date":1654300800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1654335835,"objectID":"a1850e4e7e1b66b6983ec4d01c3852f7","permalink":"/post/sistema-dados-geograficos-iii/","publishdate":"2022-06-04T00:00:00Z","relpermalink":"/post/sistema-dados-geograficos-iii/","section":"post","summary":"Caso n√£o tenha visto as publica√ß√µes anteriores, deixo aqui o link e os temas abordados:\n Na primeira publica√ß√£o falo sobre o django-geojson para simular um campo geogr√°fico no models; o geojson para criar um objeto da classe geojson e realizar as valida√ß√µes necess√°rias para garantir robustez do sistema, e a cria√ß√£o do formul√°rio de registro de dados usando o ModelForm; Na segunda publica√ß√£o apresento os validadores de campo do Django como uma ferramenta fundamental na qualidade dos dados espaciais, sem depender de infraestrutura SIG (GIS).","tags":["pt-br","Python"],"title":"Criando um sistema para gest√£o de dados geogr√°ficos de forma simples e robusta III","type":"post"},{"authors":[],"categories":[],"content":"A carreira profissional sob a √≥tica de um tabuleiro de xadrez  Nota: O presente artigo foi originalmente publicado na primeira edi√ß√£o da revista HBNetwork.\n Aviso antes que seja tarde: n√£o sou formado na √°rea de desenvolvimento, ainda que atue na √°rea de an√°lise de dados e como solucionador de problemas a partir do uso de programa√ß√£o. E tampouco sou um ex√≠mio jogador de xadrez. Com rela√ß√£o a este √∫ltimo ponto, como voc√™s devem se imaginar, estou com as centenas de milhares de pessoas que se permitiram aprender sobre esse lindo jogo depois de assistir √† ≈õerie ‚ÄúO gambito da rainha‚Äù. Contudo, n√£o considero esses fatos como problema, j√° que o que pretendo fazer aqui √© uma analogia entre o jogo de xadrez e nossa carreira profissional.\nSim, escrever este texto √© uma ousadia de minha parte: al√©m de estar fazendo uma analogia entre dois temas aos quais n√£o me considero apto para tal, se trata apenas de um exerc√≠cio mental e hipot√©tico. Ciente disto, n√£o terei a menor inten√ß√£o de esgotar todas as possibilidades metaf√≥ricas, nem em t√™-las como √∫nicas e verdadeiras. A inten√ß√£o do texto √©, nada mais que convid√°-los a pensar o nosso desenvolvimento profissional sob uma nova perspectiva, com o √∫nico objetivo de exercitar. Logo, n√£o tenho d√∫vidas que algumas abordagens aqui adotadas deixar√£o alguns pontos sem explica√ß√£o/solu√ß√£o.\nAviso dado, comento de onde surgiu a ideia: Sou formado em Geografia e, al√©m de atuar nas √°reas mencionadas antes, sou tamb√©m professor de Geopol√≠tica que, assim como os temas das rela√ß√µes internacionais, possui como met√°fora principal o jogo do xadrez. Imagino que j√° tenham escutado algo como ‚Äúo xadrez geopol√≠tico no oriente m√©dio‚Äù. Mas em que sentido, isso? Devo imaginar o presidente do Ir√£ jogando xadrez contra o presidente do Iraque, onde as pe√ßas seriam recursos de seus respectivos pa√≠ses? Ou seria o caso de pensar o mundo como um imenso tabuleiro de xadrez onde cada pa√≠s desempenha um papel e, neste caso, Ir√£ e Iraque seriam algumas das pe√ßas em movimentos importantes? Pois √©, ambas possibilidades s√£o pertinentes.\nComo at√© os menos instru√≠dos no jogo j√° devem saber, cada pe√ßa possui habilidades diferentes de movimenta√ß√£o e captura de outras pe√ßas. Reconhecer essas diferentes habilidades √© importante para sabermos at√© que ponto nossos colegas poder√£o nos dar cobertura em alguma movimenta√ß√£o arriscada ou quando ser√° a nossa vez de faz√™-lo para que outros se desenvolvam. Ou podemos, ainda, pensar em cada pe√ßa como as diferentes habilidades que temos o potencial de desenvolver. √â importante conhec√™-las, tentar desenvolv√™-las mas sem cair em armadilhas.\nE, s√≥ para constar, ainda que tenhamos um oponente ao jogar xadrez, n√£o quero dar muita √™nfase a ele nas analogias, para n√£o cair numa vis√£o rasa de que estamos lutando contra algu√©m, ainda que √†s vezes seja conveniente: voc√™ executa alguns movimentos buscando um objetivo (melhoria salarial, por exemplo) e n√£o o alcan√ßa, pois o oponente simplesmente n√£o moveu suas pe√ßas como voc√™ havia pensado, podendo, ent√£o, colocar culpa do seu fracasso no oponente.\nMas vamos ao que interessa: selecionei tr√™s conceitos b√°sicos de xadrez a partir dos quais nos permitir√£o refletir sobre as poss√≠veis abordagens de desenvolvimento pessoal e profissional:\nPe√£o promovido: Uma iniciativa comum aos que n√£o conhecem alguns conceitos b√°sicos de estrat√©gia √© o de tentar a todo custo chegar com o pe√£o ao outro lado do tabuleiro. Cruzando as 8 casas para, ent√£o, se tudo der certo, ter o seu pe√£o promovido. Nessa promo√ß√£o o pe√£o pode se transformar em qualquer uma das outras pe√ßas (exceto rei e pe√£o, n√£o faria sentido, n√©?).\nSeria leviano ‚Äúapostar todas nossas fichas‚Äù em um √∫nico pe√£o, pe√ßa com movimenta√ß√£o extremamente limitada, que, sozinho, deveria cruzar todo o tabuleiro para ent√£o ser promovido a uma pe√ßa com maior possibilidade de movimenwta√ß√£o e que, ent√£o, e em teoria, nos daria mais poder. √â leviano n√£o apenas pelo risco, mas tamb√©m pelo fato de dispormos de pe√ßas com diferentes habilidades de movimenta√ß√£o.\nJ√° entenderam onde quero chegar, n√£o? Ali√°s, a ideia de promo√ß√£o do pe√£o vem como uma met√°fora √† ascens√£o social a partir de um caminho virtuosos (reto).\nReitero: A quest√£o aqui √© o custo de oportunidade em sua execu√ß√£o. Al√©m de deixar de desenvolver outras pe√ßas com diferentes habilidades, acaba-se por expor uma fraqueza pois, ao n√£o poderem retroceder, o pe√£o poder√° ficar como ‚Äúpe√£o isolado ‚Äú, outro conceito importante do xadrez. Algo que pode ser como ‚Äúo vale das sombras‚Äù que o Henrique Bastos tanto fala‚Ä¶ Ainda que o pe√£o seja considerado uma pe√ßa de pouco valor, n√£o vale a pena permitir que ela apresente uma debilidade no desenvolvimento do jogo (carreira).\nImagem: Pe√£o branco na posi√ß√£o e6 est√° isolado sem prote√ß√£o de outra pe√ßa.\nComo evitar essa debilidade? Existem algumas ‚Äúestruturas de pe√µes‚Äù, onde movem-se diferentes pe√ßas dessa categoria de forma que uma d√™ prote√ß√£o a outra. Um exemplo est√° na forma√ß√£o de uma cadeia de pe√µes que, ao estarem em diagonal, acabam por proteger-se de potenciais ataques, n√£o os evitando mas garantindo que ao serem atacados outros poder√£o contra-atacar. Ali√°s, uma das defesas mais famosas, chamada de ‚ÄúDefesa Francesa‚Äù se baseia nessa proposta. Esp√≠rito de equipe e consci√™ncia social √© tudo, n√£o √© mesmo?\nImage: Defesa francesa: grupo de pe√µes negros formando uma cadeia de pe√µes em diagonal, tornando o ataque mais arricado.\nDom√≠nio do centro: Um conceito importante a ser considerado no xadrez √© o de dom√≠nio do centro do tabuleiro. Longe de definir qualquer partida, o dom√≠nio do centro √© a estrat√©gia de posicionar algumas pe√ßas de forma a ter ao seu alcance o dom√≠nio de mais casas (n√£o quero usar a palavra amea√ßar pra n√£o entrar numa vis√£o manique√≠sta). Mas dito dom√≠nio n√£o pode ser pensado apenas pela presen√ßa de uma ou outra pe√ßa em posi√ß√£o estrat√©gica, como se uma bandeira garantisse, por si s√≥, a posse de um territ√≥rio. √â estrat√©gico ter outras pe√ßas (habilidades?) dando cobertura √†s que est√£o tentando dominar o centro. Assim como se faz com a cadeia de pe√µes. Afinal, ao tentar dominar o centro, se est√°, por consequ√™ncia, se expondo, gerando uma debilidade.\nImagem: Pe√ßas brancas posicionadas de forma a, n√£o apenas dominar o centro (casas marcadas com c√≠rculo verde), mas tamb√©m, com outras pe√ßas protegendo os pe√µes mais avan√ßados (setas verdes).\nPara finalizar, acho legal comentar que, ao meu ver, toda vulnerabilidade mencionada sempre existir√°. Afinal, ‚ÄúS√≥ n√£o erra quem n√£o tenta‚Äù. E √© a√≠ que eu acho que entra um pouco essa ideia de autonomia: reconhec√™-las, afinal, ningu√©m √© perfeito, para trabalh√°-las de forma a reduzir a perda potencial.\nO que achou dessas an√°lises? Acrescentaria alguma coisa? N√£o deixe de dar uma olhada nos demais artigos publicados na revista HBNetwork.\nLinks: Portifolio Github Linkedin Twitter\n","date":1651449600,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1651494541,"objectID":"c82dfd003b36a76b22175873d723b46d","permalink":"/post/carreira-e-xadrez/","publishdate":"2022-05-02T00:00:00Z","relpermalink":"/post/carreira-e-xadrez/","section":"post","summary":"A carreira profissional sob a √≥tica de um tabuleiro de xadrez  Nota: O presente artigo foi originalmente publicado na primeira edi√ß√£o da revista HBNetwork.\n Aviso antes que seja tarde: n√£o sou formado na √°rea de desenvolvimento, ainda que atue na √°rea de an√°lise de dados e como solucionador de problemas a partir do uso de programa√ß√£o.","tags":["Autoconhecimento","Autonomia","pt-br"],"title":"A carreira profissional sob a √≥tica de um tabuleiro de xadrez","type":"post"},{"authors":[],"categories":["Python"],"content":"Como tudo come√ßou:  Nota do autor: artigo publiciado em 27/04/2022:\n Estou trabalhando num projeto onde uma das fun√ß√µes do python √© executada e recebe um um par√¢mtero pelo terminal. Um detalhe √© que esse par√¢metro √© o nome de uma pessoa. Um ponto que n√£o previ no processo de desenvolvimento √© que nomes, como qualquer outro elemento textual da lingua portuguesa, podem ter acentos (ou \u0026ldquo;caracteres especiais\u0026rdquo;).\nPois √©, foi praticamente sem querer que vi, olhando os logs produzidos, que os nomes com acento estavam com problema de encoding.\nE assim come√ßou a minha ca√ßa ao bug. Uma ca√ßa que me tomou um dia e meio. Mas foi de grande aprendizado.\nUm pouco do contexto: Antes de descrever essa aventura, comento um pouco o fluxo do programa que apresentou erro:\n Uma fun√ß√£o √© executada pelo terminal e recebe um par√¢mtero, que √© o nome de uma pessoa; Esse nome √© usado para instanciar um objeto. Logo no __init__ tenho o ponto de acesso ao que foi informado pelo terminal com a incorpora√ß√£o do mesmo como atributo da inst√¢ncia. Alguns processamnetos, que n√£o vem ao caso, s√£o realizados; O log do processamento realizado √© persistirdo numa base de dados usando o SQLAlchemy, onde a tabela que o recebe possui um campo id e outro json, com os logs organizados em tal formato.  E agora? Por onde come√ßar? Buscando o bug no terminal\nComo o par√¢metro estava sendo passado por terminal, achei que o problema estava nesse ponto: no terminal. Primeiro passo: checar o encoding usado pelo sistema. Mas logo vi que estava tudo em utf-8, o que por s√≠, n√£o deveria apresentar problema.\nComo o nome estava sendo passado como um par√¢metro do sistema a partir de uma vari√°vel, aproveitei para checar se o erro n√£o estava a√≠. Nada que um print e alguns testes no terminal n√£o resolva. E nada, os nomes armazenados na vari√°ve e passados como par√¢metro n√£o sofriam qualquer altera√ß√£o neste processo inicial.\nInterse√ß√£o terminal/python\nAchei, ent√£o que o erro estava em alguma incompatibilidade entre o que era passado no terminal e o como o python estava recebendo.\nSegundo passo, ent√£o, foi checar o ponto de contato entre terminal e o python. Ler o seguinte trecho, de uma resposta do stackOverFlow me deu a certeza de que era a√≠ o erro:\n When Python does not detect that it is printing to a terminal, sys.stdout.encoding is set to None.\n Ou seja, quando o python n√£o pode detectar o que est√° sendo apresentado ao terminal o sys.stdout.encoding √© definido como None; Ora, estou passando um parametro a partir de uma vari√°vel do terminal, logo um string. O Python n√£o consegue identificar o encoding dessa string e est√° definindo, ent√£o o encoding a None, o que deve estar gerando o erro.\nTentando resolver isso, busquei alguma forma de declarar o encoding\u0026hellip; Cheguei a adicionar ao __init__, quando a classe √© instanciada e recebe o nome da pessoa os m√©todos, .encode().decode('utf-8') ao objeto que recebe o valor. Parecia que ia funcionar, vejam:\nnome = 'Felipe Sodr√©' b'Felipe Sodr\\xc3\\xa9' # e ao adicionar o decode o texto volta ao normal... nome.encode().decode('utf-8') 'Felipe Sodr√©'  \u0026ldquo;Meio\u0026rdquo; gambiarra, n√£o? Mas o importante √© se funcionar.\nContudo, o que parecia a solu√ß√£o, foi logo por agua abaixo na primeira rodada de teste. O nome continua com erro de encoding.\nDecid√≠, ent√£o, usar o m√≥dulo logging para apresentar o nome recebido pelo terminal e nome ap√≥s a classe estar instanciada durante o processamento. Ali√°s, o @dunosauro apresentou uma live muito boa sobre o uso do logging\u0026hellip;\nBom, ao usar o logging tive certeza de que estava tentando resolver o erro no ponto errado, todas as mensagens de log estavam sem o tal erro de encoding, mas no log persistido no banco de dados seguia com o maldito erro\u0026hellip;\nSer√° que o banco de dados est√° configurado com uma encoding diferente?\nNo banco de dados\u0026hellip;\n‚úîÔ∏è Banco configurado como \u0026lsquo;utf-8\u0026rsquo;;\nAt√© que me veio uma luz: nas mensagens de log o nome est√° sem erro. Mas o log que est√° sendo persistido no banco de dados ( que s√£o algumas dessas mensagens filtradas para monitorar alguns pontos importantes do sistema) √© uma compila√ß√£o salva em um campo JSON.\n\u0026ldquo;Bom deve ser nesse ponto, ent√£o.\u0026rdquo;, pensei.\nReproduzindo o erro em JSON\nParti ent√£o para tentar reproduzir esse erro:\n\u0026gt;\u0026gt;\u0026gt;import json \u0026gt;\u0026gt;\u0026gt;info = {'nome':'Felipe Sodr√©', 'idade':38} \u0026gt;\u0026gt;\u0026gt;info {'nome': 'Felipe Sodr√©', 'idade': 28} \u0026gt;\u0026gt;\u0026gt;json.dumps(info) '{\u0026quot;nome\u0026quot;: \u0026quot;Felipe Sodr\\xc3\\xa9\u0026quot;, \u0026quot;idade\u0026quot;: 38}'  Pronto! A√≠ est√° o problema. No processo de convers√£o do dicion√°rio ao JSON, h√° algum tipo de convers√£o que gera o erro de encoding.\nN√£o levei \u0026ldquo;muito tempo\u0026rdquo; (tempo √© relativo, n√©?) para encontrar que o m√©todo dumps() possui o par√¢metro ensure_ascii, com valor padr√£o True, que garante que as strings do JSON que possuam caracteres n√£o-ASCII estejam com scape.:\n If ensure_ascii is true (the default), the output is guaranteed to have all incoming non-ASCII characters escaped. If ensure_ascii is false, these characters will be output as-is.\n Testei usando o dumps() com ensur_ascii=False:\n\u0026gt;\u0026gt;\u0026gt;json.dumps(info, ensure_ascii=False) '{\u0026quot;nome\u0026quot;: \u0026quot;Fl√°via Duarte Nascimento\u0026quot;, \u0026quot;idade\u0026quot;: 12}'  Pronto, ponto de erro encontrado. Basta adicionar o par√¢metro apra False e tudo se resolveria.\nMas n√£o foi bem assim, ainda faltava um ponto. Eu n√£o estava gerando o dump e salvando no banco. O que estou fazendo √© passar o dado, ainda em dicion√°rio, para o banco usando o SQLAlchemy e ele cuida disso para mim.\nComo, ou melhor, onde, ent√£o, eu devo informar esse ensure_ascii?\nEnfim, a solu√ß√£o: Foi lendo essa responta no SOF que entend√≠ que como o ORM SQLAlchemy est√° cuidadno disso para mim, ele possui um serializador e que o mesmo √©, nada mais, nada menos que os m√©todos jason.dumps() e json.loads(), passados na fun√ß√£o create_engine como um kwargs:\nengine = create_engine(..., json_serializer=dumps)\nO golpe final foi ao ler a docuementa√ß√£o do SQLAlchemy sobre o tipo de dado JSON e aprender que podemos customizar o serializador. Olha s√≥ o exemplo da documenta√ß√£o, me dando de \u0026ldquo;bandeja\u0026rdquo; a solu√ß√£o para o bug em quest√£o:\nengine = create_engine( \u0026quot;sqlite://\u0026quot;, json_serializer=lambda obj: json.dumps(obj, ensure_ascii=False))  Agora sim, vida que segue, gra√ßas √† persist·∫Ωncia e perseveran√ßa na ca√ßa aos bugs.\nAh, claro. Essa investiga√ß√£o contou com a ajuda de outros colegas que dedicaram alguns minutos para conversar e propor solu√ß√µes, tab√©m. Muito obrigado!\n nota do autor: artigo publiciado em 27/04/2022:\n Quando achei que estava tudo funcionando e coloquei em produ√ß√£o a corre√ß√£o, eis que me deparo com um novo erro. Dessa vez um TypeError:\nraise TypeError(f'Object of type {o.__class__.__name__} ' sqlalchemy.exc.StatementError: (builtins.TypeError) Object of type datetime is not JSON serializable  Com algumas pesquisas, pude identificar que, como estou indicando um serializador, Todo objeto a ser inluido no JSON passar√° por ele. Mas, como o pr√≥prio erro informa, um objeto datetime n√£o pode ser seriaizado. E por isso que o m√©todo json.dumps(), al√©m de ter o par√¢metro ensure_ascii, possui um argumento para a serializa√ß√£o padr√£o.\nPortanto o √∫ltimo bug foi resolvido usando o par√¢metro default=str. Ou seja, o serializador padr√£oa pe transformar o objeto a uma classe string.\nO codigo ficou, ent√£o da seguinte forma:\nengine = create_engine( \u0026quot;sqlite://\u0026quot;, json_serializer=lambda obj: json.dumps(obj, ensure_ascii=False, default=str))  E voc√™s, que estrat√©gias adotam na ca√ßa aos bugs?\nNote: image from @ThePracticalDev\n","date":1649980800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1650023953,"objectID":"c0e49d9e5b06e9cf4a0d989ca7de84d1","permalink":"/post/bug-buster/","publishdate":"2022-04-15T00:00:00Z","relpermalink":"/post/bug-buster/","section":"post","summary":"Como tudo come√ßou:  Nota do autor: artigo publiciado em 27/04/2022:\n Estou trabalhando num projeto onde uma das fun√ß√µes do python √© executada e recebe um um par√¢mtero pelo terminal.","tags":["Python","Autonomia","Bug fixing","pt-br"],"title":"Bug buster","type":"post"},{"authors":[],"categories":null,"content":"Hacktoberfest: Colabora√ß√µes e aprendizados Artigo publicado tamb√©m no linkedin.\nO HacktoberFest √© um evento promovido pela Digital Ocean durante o m√™s de outubro e j√° est√° na sua oitava edi√ß√£o. O objetivo √© incentivar a colabora√ß√£o em projetos de c√≥digo aberto e, claro, como uma forma de democratizar o conhecimento em sistemas de versionamento, como o git, al√©m de outras tecnologias.\n \u0026hellip;Ah, e o incentivo vem com a possibilidade de ganhar uma camisa do evento ao ter aprovado quatro pull requests em reposit√≥rios participantes (para participar, basta adicionar a tag \u0026ldquo;Hactoberfest\u0026rdquo; ao reposit√≥rio ou adicionar a tag \u0026ldquo;Hacktoberfest-accepted\u0026rdquo; no Pull request em quest√£o).\n N√£o foi minha primeira participa√ß√£o, mas foi a primeira vez que pude colaborar em projetos diferentes daqueles relacionados ao meu trabalho cotidiano. E j√° fazia algum tempo que tinha interesse em colaborar, mas n√£o sabia como quebrar a in√©rcia. Compartilho neste artigo, alguns projetos desenvolvidos este ano e o que pude aprender nos mesmos.\nFogo Cruzado O projeto Fogo Cruzado foi desenvolvido pela Volt Data Lab e Instituto Fogo Cruzado, como um sistema Crowdsourcing para monitoramento dos tiroteios no Rio de Janeiro e/ou em Recife. O mesmo disponibiliza uma API para acessar aos dados, bastando criar um usu√°rio, sem custo. E o projeto j√° tem um pacote para acessar os dados pelo R.\nComo faltava um m√≥dulo python para acessar os dados do projeto, decidi faz√™-lo durante o #Hacktoberfest. Esse foi o primeiro projeto: um m√≥dulo python para acessar os dados da API, direto do python.\nFoi um desafio legal e, at√© certa forma, simples, pois eu j√° tinha um modelo de como funcionava o pacote em R. Ent√£o o trabalho foi, principalmente \u0026ldquo;traduzir\u0026rdquo; ao python. Com isso aproveitei para refatorar algumas partes do c√≥digo.\nNo geral, posso dizer que ao desenvolver esse projeto, aprendi sobre:\n Python-poetry (do zero); Valida√ß√£o de login usando vari√°veis do sistema; Publica√ß√£o de m√≥dulos no PyPi;  E fica como desafios para melhor/implementar em breve:\n Melhorar o c√≥digo com type annotation; Cria√ß√£o de documenta√ß√£o com Sphynx (se algu√©m quiser sugerir outra alternativa ser√° bem-vinda);  PyInaturalist-convert O segundo projeto que atuei nesse m√™s foi no PyInaturalist-convert. A hist√≥ria deste m√≥dulo √© bem interessante e surge de uma demanda pessoal: O IMiBio, Institui√ß√£o onde trabalho, est√° desenvolvendo um projeto com o INaturalist, uma aplica√ß√£o de crowdsourcing para observa√ß√£o de biodiversidade, e eu tive que criar um sistema que acesse os dados do projeto usando a API deles. Com isso, conheci o m√≥dulo PyINaturalist. Conversando com os desenvolvedores, comentei que seria interessante ter os dados no padr√£o darwincore. Um deles achou pertinente e come√ßamos a desenvolver juntos. Contudo, fiquei uns bons meses afastado do projeto e ao voltar, j√° era um pacote bem estruturado. Por isso, para entender a estrutura do mesmo e saber por onde come√ßar, al√©m de ler as issues abertas, adotei a estrat√©gia de ler os testes\u0026hellip;\n\u0026hellip; E foi lendo os testes que percebi que estavam implementando um objeto geojson, \u0026ldquo;na unha\u0026rdquo;. Como estive estudando sobre o geojson (e, inclusive foi um dos temas explorados por mim em outros artigos, propus us√°-lo. Com isso, poder√≠amos usar os m√©todos de valida√ß√£o j√° implementados no m√≥dulo, garantindo consist√™ncia aos dados;\nAo colaborar no m√≥dulo PyInaturalist-converter, aprendi sobre:\n Como colaborar a um projeto j√° estruturado. Tenho certeza que essa n√£o √© uma regra. Mas foi uma boa estrat√©gia come√ßar lendo os testes; Mais aprendizados sobre python-poetry :); Soube da exist√™ncia do formatador de c√≥digo [Black](The Uncompromising Code Formatter); Soube da existencia do ISORT, para padronizar os imports;  Al√©m desses aprendizados, o autor principal do m√≥dulo j√° tinha configurado no reposit√≥rio um fluxo de a√ß√µes e valida√ß√µes bem interessantes. Dessa forma, havia um sistema de valida√ß√£o do que se estava propondo como pull request. Ainda n√£o tive tempo de me aprofundar, mas j√° est√° na lista de estudos futuros\u0026hellip;\nAn√°lise espacial no frontend Uma √∫ltima atividade que queria compartilhar, n√£o est√° relacionada a uma contribui√ß√£o minha, mas sim, um projeto ao qual eu recebi ajuda.\nPubliquei recentemente um artigo apresentando alguns m√≥dulos de JavaScript que nos permitem fazer algumas an√°lises espaciais sem depender de uma infraestrutura de servidores de dados e de mapas.\nEu fui apresentado a essas tecnologias no FOSS4G 2021 e por pura curiosidade, j√° que frontend n√£o √© a \u0026ldquo;minha praia\u0026rdquo;, comecei a fazer alguns testes como estrat√©gia de estudos, mesmo.\nPude evoluir bastante com os estudos, mas num momento vi que poderia ser feito muito mais, mas que eu n√£o tinha conhecimento t√©cnico em JS para isso. N√£o tive d√∫vidas em contactar um amigo que trabalha com JS e apresentei a ele o que estava tentando fazer. Ele curtiu e acabou colaborando com o projeto, transformando essa prova de conceito numa solu√ß√£o, em algo realmente interessante.\nPercebam que essa colabora√ß√£o n√£o surgiu pelo Hacktoberfest. Mas por uma mudan√ßa de postura minha em me conectar com outras pessoas e apresentar o que eu estava estudando, as \u0026ldquo;minhas dores\u0026rdquo; e o que pretendia fazer.\nNeste projeto estudei e aprendi sobre:\n  O georaster, uma biblioteca JavaScript que nos permite carrregar, e at√© mesmo criar, dados raster a partir de objetos JavaScript;\n  georaster-layer-for-leaflet que √© uma biblioteca que nos permite apresentar dados raster (a princ√≠pio geotif) nos mapas feitos em leaflet;\n  geoblaze que √© um pacote desenvolvido em JavaScript para permitir analisar dados carregados como georaster.\n  Como resultado, criamos dois visualizadores de dados raster apenas com tecnologia frontend. No primeiro o usu√°rio interage com o pixel (clicando num p√≠xel espec√≠fico) e o gr√°fico apresenta o comportamento temporal daquele pixel; No segundo visualizador o usu√°rio clica em um dos estados e o gr√°fico apresenta o valor m√©dio dos pixels daquele estado ao longo do tempo.\n  Notas finais sobre Hacktoberfest Entendo que muitos \u0026ldquo;torcem o nariz\u0026rdquo; para o Hacktoberfest, pois poucos o utilizam como uma estrat√©gia de estudos, crescimento ou colabora√ß√£o a projeto de c√≥digo aberto, que s√£o os objetivos principais. A ideia de escrever sobre as colabora√ß√µes feitas √© justamente destacar que o evento √© uma grande estrat√©gia/ferramenta para aprender mais, conectar-se com outros desenvolvedores e se engajar em projetos de c√≥digo aberto.\nEspero que os meus aprendizados serviam de motiva√ß√£o aos demais. Qualquer coisa, fico √† disposi√ß√£o para conversar mais a respeito.\nArtigo publicado tamb√©m no linkedin.\n","date":1636070400,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1620782712,"objectID":"8ff92882b9751e4dcb204d32d6f2e49b","permalink":"/post/hacktoberfest-2021/","publishdate":"2021-11-05T00:00:00Z","relpermalink":"/post/hacktoberfest-2021/","section":"post","summary":"Hacktoberfest: Colabora√ß√µes e aprendizados Artigo publicado tamb√©m no linkedin.\nO HacktoberFest √© um evento promovido pela Digital Ocean durante o m√™s de outubro e j√° est√° na sua oitava edi√ß√£o. O objetivo √© incentivar a colabora√ß√£o em projetos de c√≥digo aberto e, claro, como uma forma de democratizar o conhecimento em sistemas de versionamento, como o git, al√©m de outras tecnologias.","tags":["Software Livre","Hacktoberfest","Autonomia","pt-br"],"title":"Hacktoberfest 2021","type":"post"},{"authors":[],"categories":null,"content":"Criando um sistema para gest√£o de dados geogr√°ficos de forma simples e robusta Artigo publicado tamb√©m no linkedin.\nEste ano pude participar do projeto de jornalismo de dados Engolindo Fuma√ßa, desenvolvido pelo InfoAmazonia. Foi um projeto bem desafiador que me trouxe v√°rios aprendizados. Muitos deles j√° viraram artigos, como os de cubo de dados.\nAinda que o projeto tenha sido um sucesso (inclusive, foi um dos finalistas do pr√™mio de jornalismo de dados Cl√°udio Weber Abramo ) alguns desafios ficaram pendentes. Um deles est√° com a possibilidade de apresentar dados raster em um sistema webmap, sem dispor de grande infraestrutura de SIG, como base de dados e servidor de mapas, PostGIS e geoserver, respectivamente. Afinal, ap√≥s todo o processo de an√°lise de dados e produ√ß√£o das mat√©rias, era importante apresentar os dados de forma interativa.\nAli√°s, desenvolvimento de solu√ß√µes com dados espaciais com infraestrutura limitada tem sido um tema explorado por mim em alguns artigos.\nEnt√£o, em resumo, a necessidade era: apresentar as imagens de sat√©lite utilizadas nas reportagens em um mapa din√¢mico, sem depender de um servidor de mapas, para que os leitores da mat√©ria pudessem explorar os dados. Algo similar a um dashboard.\nPois foi ao moderar uma sess√£o da confer√™ncia Free and Open Source Software for Geospatial (#FOSS4G) deste ano que, sem querer, me deparei com as poss√≠veis solu√ß√µes. A solu√ß√£o seria transportar a responsabilidade de carregar, apresentar e calcular algumas estat√≠sticas ao frontend, usando o conjunto de bibliotecas georaster, georaster-layer-for-leaflet e geoblaze. A apresenta√ß√£o que me dispertou para essas ferramentas foi feita pelo Daniel Dufour sobre o geoblaze.\n georaster √© uma biblioteca JavaScript que nos permite carrregar, e at√© mesmo criar, dados raster a partir de objetos JavaScript; georaster-layer-for-leaflet √© uma biblioteca que nos permite apresentar dados raster (a princ√≠pio geotif) nos mapas feitos em leaflet; geoblaze √© um pacote desenvolvido em JavaScript para permitir analisar dados carregados como georaster.  Dessa forma, com essa stack the bibliotecas poderemos carregar uma imagem raster georreferenciada, extrair estat√≠sticas gerais e espaciais, bem como aplicar alguns processamentos, como algebra de bandas e apresent√°-las em um webmap leaflet. Tudo isso sem depender de uma infraestrutura de backend. Tudo sendo processado no frontend. Sim, essa solu√ß√£o pode ser limitada para alguns casos. Mas nem todos.\nE, por isso, decidi explorar essa alternativa, ainda que frontend (e JavaScript) n√£o seja a \u0026ldquo;minha praia\u0026rdquo;. A verdade √© que n√£o consegui conter o entusiasmo e parti para uma prova conceitual. Compartilho a prova de conceito que fiz, usando o observablehq (uma esp√©cie de jupyter-notebook para programa√ß√£o frontend).\nAproveitei para consolidar o resultado em uma landingpage. Nela, al√©m de apresentar o raster, foi poss√≠vel garantir que o usu√°rio possa interagir com o mesmo, de duas formas distintas:\n Clicando em um pixel;   ou clicando em um dos pol√≠gonos que representam os limites dos estados que comp√µem a Amaz√¥nia Legal. (‚ö†Ô∏è n√£o estamos representando o estado do Maranh√£o j√° que o mesmo n√£o √© contemplado integramente na Amaz√¥nia Legal);  Em ambas implementa√ß√µes os valores dos pixels s√£o extra√≠dos just-in-time e o gr√°fico em plotly √© atualizado representando o comportamento temporal dos mesmos. Tais dados se referem a Material Particulado \u0026lt; 2.5 do ano de 2020. No gr√°fico, apresentamos, ainda, o valor m√°ximo sugerido pela Organiza√ß√£o Mundial da Sa√∫de (World Health Organization - WHO).\nEssas duas implementa√ß√µes visam explorar oportunidades diferentes das ferramentas em quest√£o. Separamos os resultados em duas p√°ginas diferentes: clicando pixel a pixel; clicando num pol√≠gono;\nE, √© l√≥gico: tenho tudo documentado no github.\nN√£o posso deixar de mencionar que o projeto s√≥ foi poss√≠vel com a ajuda do Kyle Felipe quem, inclusive, foi o respons√°vel pela evolu√ß√£o do projeto implementando a solu√ß√£o em JS baseada na sele√ß√£o de pol√≠gonos.\nEspero que seja √∫til :)\nArtigo publicado tamb√©m no linkedin.\n","date":1635724800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1635816312,"objectID":"aa78d841eaf838d28717ae71a18a734c","permalink":"/post/analise-espacial-frontend/","publishdate":"2021-11-01T00:00:00Z","relpermalink":"/post/analise-espacial-frontend/","section":"post","summary":"Criando um sistema para gest√£o de dados geogr√°ficos de forma simples e robusta Artigo publicado tamb√©m no linkedin.\nEste ano pude participar do projeto de jornalismo de dados Engolindo Fuma√ßa, desenvolvido pelo InfoAmazonia.","tags":["Software Livre","Hacktoberfest","Autonomia","pt-br","JS"],"title":"An√°lise espacial no frontend","type":"post"},{"authors":[],"categories":[],"content":"Criando um sistema para gest√£o de dados geogr√°ficos de forma simples e robusta II Artigo publicado tamb√©m no linkedin\nNa primeira publica√ß√£o onde exploro a possibilidade de implementar um sistema de gest√£o de dados geoespaciais com Django, sem a necessidade de usar um servidor com PostGIS, vimos sobre:\n o django-geojson para simular um campo geogr√°fico no models; o geojson para criar um objeto da classe geojson e realizar as valida√ß√µes necess√°rias para garantir robustez do sistema; a cria√ß√£o do formul√°rio de registro de dados usando o ModelForm;  Agora √© hora de evoluir e expandir um pouco o sistema criado. Nessa publica√ß√£o vamos criar validadores de longitude e latitude para poder restringir a inser√ß√£o de dados a uma determinada regi√£o. Com isso, o pr√≥ximo passo (e artigo) ser√° criar o webmap no nosso sistema. Mas isso fica para breve.\nVamos ao que interessa:\nCriando validadores de longitude e latitude Sobre os validadores: Os validadores (validators, em ingl√™s) fazem parte do sistema de valida√ß√£o de formul√°rios e de campos do Django. Ao criarmos campos de uma determinada classe no nosso modelo, como por exemplo integer, o Django cuidar√° automaticamente da valida√ß√£o do valor passado a este campo pelo formul√°rio, retornando um erro quando o usu√°rio ingressar um valor de texto no campo em quest√£o, por exemplo. O interessante √© que al√©m dos validadores j√° implementados para cada classe, podemos criar outros, conforme a nossa necessidade.\n Por que necessitamos um validador para os campos de latitude e longitude?\n Como estou explorando o desenvolvimento de um sistema de gest√£o de dados geogr√°ficos com recursos limitados, ou seja, sem uma infraestrutura de opera√ß√µes e consultas espaciais, n√£o poderei consultar se o par de coordenadas inserido pelo usu√°rio est√° contido nos limites de um determinado estado (uma opera√ß√£o cl√°ssica com dados geogr√°ficos). N√£o ter essa possibilidade de valida√ß√£o poder√° colocar em risco a qualidade do dado inserido.\nE como n√£o se abre m√£o quando a quest√£o √© qualidade, uma sa√≠da ser√° a cria√ß√£o de validadores personalizados para os campos de latitude e longitude, garantindo que esses possuem valores condizentes √† nossa √°rea de interesse.\nO que precisamos saber: os validators s√£o fun√ß√µes que recebem um valor, apenas (neste caso, o valor inserido pelo usu√°rio no campo a ser validado), que passar√° por uma l√≥gica de valida√ß√£o retornando um ValidationError quando o valor inserido n√£o passar na valida√ß√£o. Com o ValidationError podemos customizar uma mensagem de erro, indicando ao usu√°rio o motivo do valor n√£o ter sido considerado v√°lido, para que o mesmo corrija.\nEnt√£o, criarei validadores dos campos de latitude e longitude para sempre que entrarem com valores que n√£o contemplem a √°rea do estado do Rio de Janeiro, um ValidationError ser√° retornado.\n ‚ö†Ô∏è Essa n√£o √© uma solu√ß√£o √≥tima j√° que, dessa forma, estamos considerando o bounding box do estado em quest√£o, e com isso haver√° √°reas onde as coordenadas ser√£o v√°lidas, ainda que n√£o estejam internas ao territ√≥rio estadual. Ainda assim, acredito que seja uma solu√ß√£o boa suficiente para alguns casos, principalmente por n√£o depender de toda infraestrutura de GIS.\n O que √© um bounding box?\nBounding box poderia ser traduzido por \u0026ldquo;ret√¢ngulo envolvente\u0026rdquo; do estado, ou de uma fei√ß√£o espacial. Na imagem abaixo, vemos o territ√≥rio do estado do Rio de Janeiro e o ret√¢ngulo envolvente que limita as suas coordenadas m√°ximas e m√≠nimas de longitude e latitude.\nPercebam que, como mencionado antes, o que conseguimos garantir √© que os pares de coordenadas estejam em alguma √°rea interna ao ret√¢ngulo em quest√£o o que n√£o garante que as mesmas estejam no territ√≥rio do estado do Rio de Janeiro.\nPor uma quest√£o de organiza√ß√£o, criei no settings.py do meu projeto as vari√°veis com os valores m√°ximos e m√≠nimos de latitude e longitude. Essa proposta surgiu do cuducos, e achei que valia a pena implementar. Entendo que √© mais organizado e evita poss√≠veis falhas humanas, caso os mesmos valores tenham que ser usados em outras partes do sistema.\nAo fim do meu settings.py, adicionei:\n# settings.py BOUNDING_BOX_LAT_MAX = -20.764962 BOUNDING_BOX_LAT_MIN = -23.366868 BOUNDING_BOX_LON_MAX = -40.95975 BOUNDING_BOX_LON_MIN = -44.887212  Agora, sim. Vamos criar os testes:\n se voc√™ n√£o entendeu o motivo pelo qual eu come√ßo criando testes, d√° uma olhada na primeira publica√ß√£o. Nela comento um pouco sobre a abordagem Test Driven Development (TDD).\n Criando os testes: No tests.py, criei uma nova classe de teste TestCase, com o objetivo de testar os validadores simulando o uso do FenomenoForm. Por isso criei staticmethod chamado create_form que cria um dicion√°rio com chaves e valores v√°lidos do formul√°rio em quest√£o, que ao receber um conjunto de argumentos nomeados **kwargs ter√° tais argumentos atualizados e usados para instanciar e retornar o FenomenoForm.\nFiz isso para, a cada teste, ter uma inst√¢ncia do FenoenoForm alterando apenas os campos que quero simular valores a serem validados, sem ter que passar sempre todos os valores do ModelForm. Assim, eu posso criar diferentes m√©todos de Test Case, usando o m√©todo criado anteriormente alterando o valor inicial a um inv√°lido, testando se de fato um ValidationError √© retornado.\n# tests.py class FenomenoFormValidatorsTest(TestCase): @staticmethod def create_form(**kwargs): valid_form = { 'nome': 'Teste', 'data': '2020-01-01', 'hora': '09:12:12', 'longitude': -42, 'latitude': -21} valid_form.update(**kwargs) form = FenomenoForm(valid_form) return form  Nos m√©todos de teste uso primeiro o assertFalse do m√©todo de valida√ß√£o do formul√°rio (form.is_valid()) para confirmar que o mesmo n√£o √© valido para, em seguida, testar com o assertEqual se o texto da mensagem de erro √© o que esperamos. Veja o link a seguir para saber sobre outros assertions.\n# tests.py def test_max_longitude_raises_error(self): form = self.create_form(longitude='-45') self.assertFalse(form.is_valid()) self.assertEqual(form.errors[\u0026quot;longitude\u0026quot;][0], 'Coordenada longitude fora do contexto do estado do Rio de Janeiro') def test_min_longitude_raises_error(self): form = self.create_form(longitude='-40') self.assertFalse(form.is_valid()) self.assertEqual(form.errors[\u0026quot;longitude\u0026quot;][0], 'Coordenada longitude fora do contexto do estado do Rio de Janeiro') def test_max_latitude_raises_error(self): form = self.create_form(latitude='-24') self.assertFalse(form.is_valid()) self.assertEqual(form.errors[\u0026quot;latitude\u0026quot;][0], 'Coordenada latitude fora do contexto do estado do Rio de Janeiro') def test_min_latitude_raises_error(self): form = self.create_form(latitude='-19') self.assertFalse(form.is_valid()) self.assertEqual(form.errors[\u0026quot;latitude\u0026quot;][0], 'Coordenada latitude fora do contexto do estado do Rio de Janeiro')  Fazemos rodar os testes e teremos erros como esses:\nCreating test database for alias 'default'... System check identified no issues (0 silenced). ...E.E.. ====================================================================== ERROR: test_max_latitude (map_proj.core.tests.FenomenoFormValidatorsTest) ---------------------------------------------------------------------- Traceback (most recent call last): File \u0026quot;/media/felipe/DATA/Repos/Django_Leaflet_Test/map_proj/core/tests.py\u0026quot;, line 78, in test_max_latitude self.assertEqual(form.errors[\u0026quot;latitude\u0026quot;][0], 'Coordenada latitude fora do contexto do estado do Rio de Janeiro') KeyError: 'latitude' ====================================================================== ERROR: test_min_latitude (map_proj.core.tests.FenomenoFormValidatorsTest) ---------------------------------------------------------------------- Traceback (most recent call last): File \u0026quot;/media/felipe/DATA/Repos/Django_Leaflet_Test/map_proj/core/tests.py\u0026quot;, line 83, in test_min_latitude self.assertEqual(form.errors[\u0026quot;latitude\u0026quot;][0], 'Coordenada latitude fora do contexto do estado do Rio de Janeiro') KeyError: 'latitude' ---------------------------------------------------------------------- Ran 8 tests in 0.012s FAILED (errors=2) Destroying test database for alias 'default'...  Ou seja, o forms ap√≥s ser validado deveria conter um atributo errors tendo como chave o nome do campo que apresentou dados inv√°lidos. Como n√£o temos os validadores criados, nenhum erro de valida√ß√£o foi acusado no campo de latitude.\nCriando e usando validadores: Para super√°-los criamos, enfim, os validadores em um arquivo validators.py. Percebam que √© nesse ponto que usarei os valores m√°ximos e m√≠nimos de latitude e longitude adicionados no settings.py:\n# validators.py from django.core.exceptions import ValidationError from django.conf import settings def validate_longitude(lon): if lon \u0026lt; settings.BOUNDING_BOX_LON_MIN or lon \u0026gt; settings.BOUNDING_BOX_LON_MAX: raise ValidationError(\u0026quot;Coordenada longitude fora do contexto do estado do Rio de Janeiro\u0026quot;, \u0026quot;erro longitude\u0026quot;) def validate_latitude(lat): if lat \u0026lt; settings.BOUNDING_BOX_LAT_MIN or lat \u0026gt; settings.BOUNDING_BOX_LAT_MAX: raise ValidationError(\u0026quot;Coordenada latitude fora do contexto do estado do Rio de Janeiro\u0026quot;, \u0026quot;erro latitude\u0026quot;)  Com esses validadores estou garantindo que ambos latitude e longitude estejam na √°rea de interesse e, caso contr√°rio, retorno um erro informando ao usu√°rio.\nE √© preciso adicion√°-los ao forms.py para que sejam usados:\n# forms.py from map_proj.core.validators import validate_longitude, validate_latitude class FenomenoForm(ModelForm): longitude = FloatField(validators=[validate_longitude]) latitude = FloatField(validators=[validate_latitude]) ...  No desenvolvimento dessa solu√ß√£o percebi pelos testes criados que, ao informar uma latitude ou longitude que n√£o passe pela valida√ß√£o, a cria√ß√£o do campo geom se tornava inv√°lido por n√£o receber um desses valores, gerando dois erros: o de valida√ß√£o do campo e o de valida√ß√£o do campo geom. Lembre-se que √© no m√©todo clean do formul√°rio que o campo geom recebe os valores de longitude e latitude formando uma classe geojson para, logo em seguida ser validado.\nPara evitar isso, alterei o m√©todo clean de forma garantir que o campo geom s√≥ seja criado e validado, quando ambos valores (longitude e latitude) existirem. Ou seja, tenham passado pelos validadores sem erro.\n#forms.py def clean(self): cleaned_data = super().clean() lon = cleaned_data.get('longitude') lat = cleaned_data.get('latitude') if not all((lon, lat)): raise ValidationError('Erro em latitude ou longitude') cleaned_data['geom'] = Point((lon, lat)) if not cleaned_data['geom'].is_valid: raise ValidationError('Geometria inv√°lida') return cleaned_data   Outro ponto (na verdade, erro) importante que s√≥ percebi a partir dos testes √© que no forms.py eu n√£o estava considerando o campo geom na lista de fields a serem usados. Com isso o mesmo n√£o √© passado ao banco de dados, mesmo passando pelo m√©todo clean que o cria.\n Por esse motivo, tive que alterar algumas coisas no forms.py:\n Inseri o campo geom √† tupla de fields do forms.py. Inseri o campo geom com um widget de HiddenInput. Esse √∫ltimo, o fiz por se tratar de um campo que n√£o quero expor ao usu√°rio, j√° que ser√° criado automaticamente no m√©todo clean.  Finalmente, a classe Meta do forms.py ficou da seguinte forma:\nclass Meta: model = Fenomeno fields = ('nome', 'data', 'hora', 'latitude', 'longitude', 'geom') widgets = {'geom': HiddenInput()}  Pronto, com tudo isso que fizemos, j√° temos um sistema que, apesar de n√£o poder fazer consultas espaciais, √© capaz de validar os campos de latitude e longitude.\nNo pr√≥ximo artigo, vou abordar sobre o que est√° por tr√°s de toda m√°gica de um webmap, usando o m√≥dulo django-leaflet. Enquanto isso, d√™ uma olhada no que tenho desenvolvido.\nArtigo publicado tamb√©m no linkedin\n","date":1625961600,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1626052857,"objectID":"bb3c87cbb7273415a6b0c046aafa4b62","permalink":"/post/criando-um-sistema-para-gestao-de-dados-geograficos-de-forma-simples-e-robusta-ii/","publishdate":"2021-07-11T00:00:00Z","relpermalink":"/post/criando-um-sistema-para-gestao-de-dados-geograficos-de-forma-simples-e-robusta-ii/","section":"post","summary":"Criando um sistema para gest√£o de dados geogr√°ficos de forma simples e robusta II Artigo publicado tamb√©m no linkedin\nNa primeira publica√ß√£o onde exploro a possibilidade de implementar um sistema de gest√£o de dados geoespaciais com Django, sem a necessidade de usar um servidor com PostGIS, vimos sobre:","tags":["pt-br","Python","Django"],"title":"Criando um sistema para gest√£o de dados geogr√°ficos de forma simples e robusta II","type":"post"},{"authors":[],"categories":["Python"],"content":"Criando um sistema para gest√£o de dados geogr√°ficos de forma simples e robusta Artigo publicado tamb√©m no linkedin.\nH√° algum tempo comecei a estudar sobre desenvolvimento de sistema com Python, usando a framework Django. Decidi expor alguns aprendizados em uma serie de artigos. A ideia √© que esses textos me ajudem na consolida√ß√£o do conhecimento e, ao t√™-los publicado, ajudar a outros que tenham interesse na √°rea.\nAproveito para deixar meu agradecimento ao Cuducos que, tanto neste artigo, como em todos meus estudos tem sido um grande mentor. Vamos ao que interessa:\nPor simples, entende-se:\n Um sistema sem a necessidade da instala√ß√£o e configura√ß√£o de base de dados PostgreSQL/GIS, Geoserver, etc; Um sistema cl√°ssico tipo Create, Retrieve, Update, Delete (CRUD) para dados geogr√°ficos; Um sistema que n√£o demande opera√ß√µes e consultas espaciais; Mas um sistema que garanta a qualidade na gest√£o dos dados geogr√°ficos;  Vis√£o geral da proposta: Vamos criar um ambiente virtual Python e instalar a framework Django, para criar o sistema, assim como alguns m√≥dulos como jsonfield, que nos vai habilitar a cria√ß√£o de campos JSON em nossa base de dados; django-geojson, que depende do jsonfield e ser√° respons√°vel por habilitar inst√¢ncias de dados geogr√°ficos, baseando-se em JSON; geojson, que possui todas as regras b√°sicas de valida√ß√£o de dados geogr√°ficos, usando a estrutura hom√¥nima, geojson.\nO uso desses tr√™s m√≥dulos nos permitir√° o desenvolvimento de um sistema de gest√£o de dados geogr√°ficos sem a necessidade de termos instalado um sistema de gerenciamento de dados geogr√°ficos, como o PostGIS. Sim, nosso sistema ser√° bem limitado a algumas tarefas. Mas em contrapartida, poderemos desenvolv√™-lo e implementar solu√ß√µes \u0026ldquo;corriqueiras\u0026rdquo; de forma facilitada.\nNo presente exemplo estarei usando SQLite, como base de dados.\nNosso projeto se chamar√° de map_proj. E nele vou criar uma app, dentro da pasta do meu projeto Django, chamada core. Essa organiza√ß√£o e nomenclatura usada, vem das sugest√µes do Henrique Bastos. Afinal, o sistema est√° nascendo. Ainda que eu tenha uma ideia do que ele ser√°, √© interessante iniciar com uma aplica√ß√£o \u0026ldquo;gen√©rica\u0026rdquo; e a partir do momento que o sistema se torne complexo, poderemos desacopl√°-la em diferentes aplica√ß√µes.\nCriando ambiente de desenvolvimento, projeto e nossa app: python -m venv .djleaflet # cria ambiente virtual python # ativando o ambiente virtual: source ./venv/bin/activate # atualizando o pip pip install --upgrade pip # intalando os m√≥dulos a serem usados pip install django jsonfield django-geojson geojson # criando projeto django-admin startproject map_proj . # criando app dentro do projeto cd map_proj python manage.py startapp core # criando a base de dados inicial python manage.py migrate # criando superusu√°rio python manage.py createsuperuser  Adicionando os m√≥dulos e a app ao projeto Agora √© adicionar ao map_proj/settings.py, a app criada e os m√≥dulos que usaremos.\n# setting.py INSTALLED_APPS = [ ... 'djgeojson', 'map_proj.core', ]  Perceba que para poder acessar as classes de alto n√≠vel criadas pelo pacote djgeojson, teremos que adicion√°-lo ao INSTALLED_APPS do settings.py.\nCriando a base de dados Ainda que eu concorde com o Henrique Bastos, que a vis√£o de come√ßar os projetos Django pelo models.py √© um tanto \u0026ldquo;perigosa\u0026rdquo;, por colocar √™nfase em uma parte da app e, em muitos casos, negligenciar v√°rios outros atributos e ferramentas que o Django nos oferece, irei desconsiderar sua abordagem. Afinal, o objetivo deste artigo n√£o √© explorar todo o potencial do Django, mas sim apresentar uma solu√ß√£o simples no desenvolvimento e implementa√ß√£o de um sistema de gest√£o de dados geogr√°ficos para servir como ferramenta de estudo e projeto pr√°tico.\nEm models.py usaremos inst√¢ncias de alto n√≠vel que o Django nos brinda para criar e configurar os campos e as tabelas que teremos em nosso sistema, bem como alguns comportamentos do sistema.\nComo estou desenvolvendo um sistema multi prop√≥sito, vou tentar mant√™-lo bem gen√©rico. A ideia √© que voc√™s possam imaginar o que adequar para um sistema especialista na sua √°rea de interesse. Vou criar, ent√£o, uma tabela para mapear \u0026ldquo;fen√¥menos\u0026rdquo; (quaisquer). Esse modelo ter√° os campos nome, data, hora e geometria, a qual ser√° uma inst√¢ncia de PointField.\nO PointField √© uma classe criada pelo djgeojson que nos permite usar um campo para dados geogr√°ficos sem ter toda a infraestrutura do PostGIS, instalada, por exemplo. Nesse caso, estou simulando um campo de ponto, mas, de acordo com a documenta√ß√£o do pacote, todas as geometrias usadas em dados espaciais s√£o suportadas:\n All geometry types are supported and respectively validated : GeometryField, PointField, MultiPointField, LineStringField, MultiLineStringField, PolygonField, MultiPolygonField, GeometryCollectionField. ( djgeojson )\n # models.py from django.db import models from djgeojson.fields import PointField class Fenomeno(models.Model): nome = models.CharField(max_length=100, verbose_name='Fenomeno mapeado') data = models.DateField(verbose_name='Data da observa√ß√£o') hora = models.TimeField() geom = PointField(blank=True) def __str__(self): return self.nome  Percebam que eu importo de djgeojson a classe PointField. O que o django-geojson fez foi criar uma classe [com estrutura de dados geogr√°fico] de alto n√≠vel, mas que no banco de dados ser√° armazenado em um campo JSON. Vale a pena deixar claro: n√£o espero que o usu√°rio do meu sistema saiba preencher o campo geom em formato JSON. Por isso, criarei no forms.py, os campos latitude e longitude e a partir deles, o campo geom ser√° preenchido. Detalharei esse processo mais adiante.\nPronto, j√° temos o modelo da \u0026lsquo;tabela de dados \u0026ldquo;geogr√°ficos\u0026rdquo;\u0026rsquo;, mas esse modelo ainda n√£o foi registrado em nossa base. Para isso:\npython manage.py makemigrations python manage.py migrate  O makemigrations analisa o models.py e o compara com a vers√£o anterior identificando as altera√ß√µes e criando um arquivo que ser√° executado pelo migrate, aplicando tais altera√ß√µes ao banco de dados. Aprendi com o Henrique Bastos e Cuducos que o migrate √© um sistema de versionamento da estrutura do banco de dados, permitindo retroceder, quando necess√°rio, a outras vers√µes.\nCriando o formul√°rio Vou aproveitar algumas \u0026ldquo;pilhas j√° inclu√≠das\u0026rdquo; do Django, ao usar o ModelForm para criar o formul√°rio para o carregamento de dados. O ModelForm facilita esse processo.\nAli√°s, √© importante pensar que os formul√°rios do Django v√£o muito al√©m da \u0026ldquo;carga de dados\u0026rdquo;, j√° que s√£o os respons√°veis por cuidar da intera√ß√£o com o usu√°rio e o(s) processo(s) de valida√ß√£o e limpeza dos dados preenchidos.\nDigo isso, pois ao meu FenomenosForm, eu sobreescrevo o m√©todo clean(), que cuida da valida√ß√£o e limpeza do formul√°rio e incluo nele:\n a constru√ß√£o dos dados do campo geom a partir dos valores dos campos de latitude e longitude (criados exclusivamente para a ger√ß√£o do campo geom); a valida√ß√£o do campo geom;  # forms.py from django.core.exceptions import ValidationError from django.forms import ModelForm, FloatField from map_proj.core.models import Fenomeno from geojson import Point class FenomenoForm(ModelForm): longitude = FloatField() latitude = FloatField() class Meta: model = Fenomeno fields = ('nome', 'data', 'hora', 'latitude', 'longitude') def clean(self): cleaned_data = super().clean() lon = cleaned_data.get('longitude') lat = cleaned_data.get('latitude') cleaned_data['geom'] = Point((lon, lat)) if not cleaned_data['geom'].is_valid: raise ValidationError('Geometria inv√°lida') return cleaned_data  Ainda que pare√ßa simples, n√£o foi f√°cil chegar a essa estrat√©gia de estrutura√ß√£o dos models e forms. Contei com a ajuda e paciencia do Cuducos. Inicialmente eu mantinha latitude e longitude no meu models. Mas fazendo assim, al√©m de ter uma redund√¢ncia de dados e uma abertura a erros potenciais, estaria armazenando dados que n√£o devo usar depois de contruir o campo geom. Uma alternativa, discutida com o Cuducos foi de ter tanto latitude como longitude no models, mas o atributo geom como propriedade. Ainda que seja uma estrat√©gia consistente, a redund√¢ncia se mant√©m.\nO processo de valida√ß√£o do campo geom tamb√©m foi fruto de muita discuss√£o. De forma resumida, percebi que o djgeojson apenas valida o tipo de geometria do campo e n√£o a sua consist√™ncia. Ao conversar com os desenvolvedores, me disseram que toda a l√≥gica de valida√ß√£o de objetos geojson estavam sendo centralizados no m√≥dulo hom√¥nimo.\nPor isso eu carrego a classe Point do m√≥dulo geojson e designo o campo geom como inst√¢ncia dessa classe. Assim, passo a poder contar com um processo de valida√ß√£o mais consistente, como o m√©todo is_valid, usado anteriormente.\nMas e o teste? Pois √©, eu adoraria apresentar isso usando a abordagem Test Driven Development (TDD). Mas, talvez pela falta de pr√°tica, conhecimento e etc, vou apenas apontar onde e como eu testaria esse sistema. Fa√ßo isso como uma forma de estudo, mesmo. Tamb√©m me pareceu complicado apresentar a abordagem TDD em um artigo, j√° que a mesma se faz de forma incremental.\nSobre TDD Com o Henrique Bastos e toda a comunidade do Welcome to The Django vi que essa abordagem √© tanto filos√≥fica quanto t√©cnica. √â praticamente \u0026ldquo;Chora agora, ri depois\u0026rdquo;, mas sem a parte de chorar. Pois com o tempo as coisas ficam mais claras\u0026hellip; Alguns pontos:\n O erro n√£o √© para ser evitado no processo de desenvolvimento, mas sim quando estive em produ√ß√£o. Logo, Entenda o que voc√™ quer do sistema, crie um teste antes de implementar e deixe o erro te guiar at√© ter o que deseja; Teste o comportamento esperado e n√£o cada elemento do sistema;  Sem mais delongas:\nO que testar? Vamos usar o arquivo tests.py e criar nossos testes l√°. Ao abrir voc√™s v√£o ver que j√° est√° o comando importando o TestCase.\n Mas o que vamos testar?\n Como pretendo testar tanto a estrutura da minha base de dados, quanto o formul√°rio e, de quebra, a valida√ß√£o do meu campo geom, fa√ßo o import do modelo Fenomenos e do form FenomenosForm.\n‚ö†Ô∏è Essa n√£o √© uma boa pr√°tica. O ideal √© criar uma pasta para os testes e separ√°-los em arquivos distintos. Um para cada elemento do sistema (model, form, view, etc).\nO primeiro teste ser√° a carga de dados. Ent√£o, vou instanciar um objeto com o resultado da cria√ß√£o de um elemento do meu model Fenomeno. Fa√ßo isso no setUp, para n√£o ter que cri√°-lo sempre que for fazer um teste relacionado √† carga de dados.\nO teste seguinte ser√° relacionado ao formul√°rio e por isso instancio um formul√°rio com os dados carregados e testo a sua validez. Ao fazer isso o formul√°rio passa pelo processo de limpeza, onde est√° a constru√ß√£o e valida√ß√£o do campo geom. Se qualquer campo for preenchido com dados errados ou inadequados, o django retornar√° False ao m√©todo is_valid. Ou seja, se eu tiver construido o campo geom de forma equivocada, passando mais ou menos par√¢metros que o esperado o nosso teste ir√° avisar, evitando surpresas.\n# tests.py from django.test import TestCase from geojson import Point from map_proj.core.models import Fenomeno from map_proj.core.forms import FenomenoForm class ModelGeomTest(TestCase): def setUp(self): self.fenomeno = Fenomeno.objects.create( nome='Arvore', data='2020-11-06', hora='09:30:00' ) def test_create(self): self.assertTrue(Fenomeno.objects.exists()) class FenomenoFormTest(TestCase): def setUp(self): self.form = FenomenoForm({ 'nome': 'Teste', 'data': '2020-01-01', 'hora': '09:12:12', 'longitude': -45, 'latitude': -22}) self.validation = self.form.is_valid() def test_form_is_valid(self): \u0026quot;\u0026quot;\u0026quot;\u0026quot;form must be valid\u0026quot;\u0026quot;\u0026quot; self.assertTrue(self.validation) def test_geom_coordinates(self): \u0026quot;\u0026quot;\u0026quot;after validating, geom have same values of longitude and latitude\u0026quot;\u0026quot;\u0026quot; self.assertEqual(self.form.cleaned_data['geom'], Point( (self.form.cleaned_data['longitude'], self.form.cleaned_data['latitude']))) def test_geom_is_valid(self): \u0026quot;\u0026quot;\u0026quot;geom must be valid\u0026quot;\u0026quot;\u0026quot; self.assertTrue(self.form.cleaned_data['geom'].is_valid)  ‚ö†Ô∏è Reparem que:\n No test_create() eu testo se existem objetos inseridos no model Fenomeno. Logo, testo se o dado criado no setUp foi corretamente incorporado no banco de dados. Na classe FenomenosFormTest eu crio uma inst√¢ncia do meu modelForm e realizo tr√™s testes:  test_form_is_valid() estou testando se os dados carregados s√£o condizentes com o informado no model e, pelo fato desse m√©todo usar o m√©todo clean(), posso dizer que estou testando indiretamente a validez do campo geom. Caso ele n√£o fosse v√°lido, o form tamb√©m n√£o seria v√°lido. Em test_geom_coordinates() testo se ap√≥s a valida√ß√£o o campo geom foi criado como esperado (como uma inst√¢ncia de Point com os dalores de longitude e latitude). O teste test_geom_is_valid() serve para garantir que a contru√ß√£o do campo geom √© valido. Ainda que ao testar se o formul√°rio √© valido eu estaria implicitamente testando a validez do campo geom, esse teste serve para garantir a cria√ß√£o v√°lida do campo. Afinal, por algum motivo (como por exemplo, refatora√ß√£o), pode ser que fa√ßamos alguma altera√ß√£o no m√©todo clean() que mantenha o formul√°rio como v√°lido mas deixe de garantir a validez do campo geom.    A diferen√ßa entre as classes de teste criadas est√° no fato de ao inserir os dados usando o m√©todo create() - e aconteceria o mesmo se estivesse usando o save() -, apenas ser√° validado se o elemento a ser inserido √© condizente com o tipo de coluna no banco de dados. Vale deixar claro: Dessa forma, eu n√£o estou validando a consist√™ncia do campo geom, j√° que o mesmo, caso seja informado, ser√° salvo com sucesso sempre que represente um JSON.\nEsse fato √© importante para refor√ßar o entendimento de que o djgeojson implementa classes de alto n√≠vel a serem trabalhados em views e models. No banco, mesmo, temos um campo de JSON. Enquanto que, para poder validar a consist√™ncia do campo geom, preciso passar os dados pelo formul√°rio onde, no processo de limpeza do mesmo, o campo ser√° criado e validado usando o m√≥dulo geojson. Por isso a classe com os testes relacionados ao comportamento do formul√°rio.\nRegistrando modelo no admin Para facilitar, vou usar o django-admin. Trata-se de uma aplica√ß√£o j√° criada onde basta registrar os modelos e views que estamos trabalhando para termos uma interface \u0026ldquo;frontend\u0026rdquo; gen√©rica.\n#admin.py from django.contrib import admin from map_proj.core.models import Fenomeno from map_proj.core.forms import FenomenoForm class FenomenoAdmin(admin.ModelAdmin): model = Fenomeno form = FenomenoForm admin.site.register(Fenomeno, FenomenoAdmin)  To be continued\u0026hellip; At√© o momento j√° temos algo bastante interessante: um sistema de CRUD que nos permite adicionar, editar e remover dados geogr√°ficos. Talvez voc√™ esteja pensando consigo mesmo:\n \u0026ldquo;OK. Mas o que foi feito at√© agora, poderia ter sido feito basicamente com uma base de dados que possuam as colunas latitude e longitude\u0026rdquo;.\n Eu diria que sim, at√© certo ponto. Uma grande diferen√ßa, eu diria, da forma como foi implementada √© o uso das ferramentas de valida√ß√£o dos dados com o m√≥dulo geojson.\nA ideia √©, a seguir (e seja l√° quando isso for), extender a funcionalidade do sistema ao implementar um webmap para visualizar os dados mapeados.\nArtigo publicado tamb√©m no linkedin.\n","date":1620345600,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1626053112,"objectID":"b283e7331b7caf56017e55eb67d7ae6a","permalink":"/post/criando-um-sistema-para-gestao-de-dados-geograficos-de-forma-simples-e-robusta/","publishdate":"2021-05-07T00:00:00Z","relpermalink":"/post/criando-um-sistema-para-gestao-de-dados-geograficos-de-forma-simples-e-robusta/","section":"post","summary":"Criando um sistema para gest√£o de dados geogr√°ficos de forma simples e robusta Artigo publicado tamb√©m no linkedin.\nH√° algum tempo comecei a estudar sobre desenvolvimento de sistema com Python, usando a framework Django.","tags":["Django","Python","pt-br"],"title":"Criando um sistema para gest√£o de dados geogr√°ficos de forma simples e robusta","type":"post"},{"authors":[],"categories":["R"],"content":" Nas √∫ltimas semanas estive trabalhando em um projeto com dados atmosf√©ricos. Tem sido de grande aprendizado n√£o apenas por ser uma tem√°tica nova, mas tamb√©m pela demanda de processamento de dados.\nOs aprendizados relacionados ao processamento de dados (sua otimiza√ß√£o, claro), ser√£o abordados em artigos ainda em produ√ß√£o. Mas um ponto fundamental e que percebi ser ignorado pela maioria, e neste sentido me incluo, √© a estrutura de dados dos arquivos raster em netCDF.\nJ√° vi, e j√° respodi a muitas pessoas perguntando como carregar dados netCDF no R, com um simples ‚Äúcom o pacote raster, ora bolas‚Äù. No pior das hip√≥teses, teremos apenas que instalar uma dependencia que √© o pacote ncdf4.\nPois √©, os dados atmosf√©ricos que tenho trabahado est√£o em formato netCDF. E usar o pacote raster para carreg√°-lo e manipul√°-lo, me foi √∫til enquanto a an√°lise era explorat√≥ria. Ao ver o volume de dados crescer de tr√™s dias para dois meses e, em seguida para dois anos de dados produzidos a cada tr√™s horas do dia, todos os dias, totalizando 731 arquivos, percebi que precisaria deixar de pregui√ßa e entender esse tal de netCDF.\nLendo sobre o pacote ncdf41, o formato netCDF √© descrito da seguinte forma:\n ‚Äúbinary data files that are portable across platforms and include metadata information in addition to the data sets.‚Äù\n Acho nesse fragmento j√° d√° para entender a import√¢ncia do formato, n√£o?\nVamos entender isso? Vejam a diferen√ßa:\nlibrary(raster) ## Loading required package: sp (r.ppm25 \u0026lt;- stack(\u0026quot;./rasters/ppm25_2019-06-30.nc\u0026quot;)) ## Loading required namespace: ncdf4 ## class : RasterStack ## dimensions : 59, 75, 4425, 6 (nrow, ncol, ncell, nlayers) ## resolution : 0.4, 0.4 (x, y) ## extent : -74.19, -44.19, -18.24, 5.36 (xmin, xmax, ymin, ymax) ## crs : +proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0 ## names : X2019.06.30.12.00.00, X2019.06.30.15.00.00, X2019.06.30.18.00.00, X2019.06.30.21.00.00, X2019.07.01.00.00.00, X2019.07.01.03.00.00 Aos que j√° trabalham com o pacote raster e conhecem os dados raster, poder√£o ver que, sim, ainda que dependendo do ncdf4, o raster carrega os dados, aparentemente, sem grandes problemas. O m√≠nimo esperado est√° a√≠. Um raster, com um extent, linhas, colunas, c√©lulas, layers‚Ä¶\nMas, se os dados est√£o em netCDF, e esse tipo de dados permite armazenar metadados tamb√©m, cad√™ eles?\nPois √©. Ao ignorar isso, passava por cima desse detalhe como um marreteiro diante de um parafuso.\nVamos abrir o arquivo com o ncdf4 para come√ßar a identificar alguns pontos importantes, que, por sinal n√£o ficam ‚Äúapenas‚Äù no metadados:\nlibrary(ncdf4) (nc.ppm25 \u0026lt;- nc_open(\u0026quot;./rasters/ppm25_2019-06-30.nc\u0026quot;)) ## File ./rasters/ppm25_2019-06-30.nc (NC_FORMAT_64BIT): ## ## 1 variables (excluding dimension variables): ## short pm2p5[longitude,latitude,time] ## scale_factor: 9.668789576322e-12 ## add_offset: 3.16807559257767e-07 ## _FillValue: -32767 ## missing_value: -32767 ## units: kg m**-3 ## long_name: Particulate matter d \u0026lt; 2.5 um ## standard_name: mass_concentration_of_pm2p5_ambient_aerosol_particles_in_air ## ## 3 dimensions: ## longitude Size:75 ## units: degrees_east ## long_name: longitude ## latitude Size:59 ## units: degrees_north ## long_name: latitude ## time Size:6 *** is unlimited *** ## units: hours since 1900-01-01 00:00:00.0 ## long_name: time ## calendar: gregorian ## ## 2 global attributes: ## Conventions: CF-1.6 ## history: 2021-03-17 20:27:56 GMT by grib_to_netcdf-2.20.0: grib_to_netcdf /data/scratch/20210317-2020/8e/_mars-webmars-public-svc-blue-001-6fe5cac1a363ec1525f54343b6cc9fd8-ZAB6WD.grib -o /data/scratch/20210317-2020/b1/_grib2netcdf-webmars-public-svc-blue-000-6fe5cac1a363ec1525f54343b6cc9fd8-VDR6DW.nc -utime Antes de comentar toda riqueza e detalhamento de informa√ß√£o que nos brinda o ncdf4, percebam que o comando √© nc_open(). N√£o importa de o dado tem uma ou mais ‚Äúbandas‚Äù ou ‚Äúcamadas‚Äù. Isso me chamou aten√ß√£o pois, como acham que vou saber a quantidade de camadas do dados que vou abrir, se ainda n√£o o conhe√ßo? Mas enfim. Vamos ao mais importante, os detalhes:\nVeja a estrutura√ß√£o. No arquivo em quest√£o, eu tenho uma vari√°vel apenas, que possui v√°rios metadados, garantindo minimamente sua compreens√£o, como: short_name, no caso ‚Äúpm2p5‚Äù, units, para descrever a unidade do dado, long_name e standart_name, al√©m de v√°rios outros.\nE vejam tamb√©m que s√£o identificadas tr√™s dimens√µes: longitude, latitude e time;\nEis que chegamos ao cubo de dados, n√£o faz sentido?\nEu tenho uma vari√°vel (ppm\u0026lt;2.5) medida para uma mesma √°rea (cena) ao longo do tempo. O netCDF, como est√° preparado e pensado para esse tipo de situa√ß√£o j√° entende os dados como informa√ß√£o de dadta e hora (!) e os organiza como uma dimens√£o do dado e n√£o atributo. O raster, por ter outros objetivos, carrega tudo como um stack (empilhamento de camadas) e adiciona uma string ‚ÄúX‚Äù ao nome das camadas, j√° que as mesmas s√£o num√©ricas e o pacote em quest√£o restringe o prefixo das camadas a texto, n√£o permitindo valores num√©ricos. Enfim, nos obriga a digitar mais algumas linhas de c√≥digo para que o dado fique mais apresent√°vel.\nFonte da imagem: r-spatial.github.io\n Essa forma de estruturar os dados far√° todo o sentido mais √† frente quando formos falar um pouco mais do processamento desses dados.\nO pacote ncdf4 est√° desenvolvido para o que se conv√™m chamar de CRUD, na √°rea de desenvolvimento de sistemas: Create, Update and Delete. Ou, seja, a ideia √© fornecer ferramentas para manipular e ter controle total dos dados, criando, abrindo, alterando dimens√µes ou atributos e por a√≠ vai. Mas n√£o para visualiza√ß√£o nem para as an√°lises. Essas, ficar√£o para os pr√≥ximos artigos.\nEnquanto isso, fique √† vontade em me contactar, dar uma al√¥ l√° no grupo do GeoCastBrasil, no Telegram ou no nosso canal do youtube.\n N√£o pretendo explorar muitos detalhes, mas o nome do pacote (ncdf4) faz refer√™ncia √† vers√£o 4 de estratura em quest√£o. Portanto, caso voc√™ esteja, por algum motivo, usando um arquivo netCDF com vers√£o anterior, o pacote ncdf segue dispon√≠vel, ainda que descontinuado.‚Ü©\n   ","date":1615939200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1616033847,"objectID":"9df6eaa827f7e8f7f0cdb3ac35ab20ff","permalink":"/post/netcdf/","publishdate":"2021-03-17T00:00:00Z","relpermalink":"/post/netcdf/","section":"post","summary":"Entenda o porqu√™ o netCDF √© um grande aliado","tags":["pt-br","R"],"title":"Para quem s√≥ sabe usar martelo, todo problema √© um prego. At√© rasters em formato netCDF.","type":"post"},{"authors":null,"categories":null,"content":"","date":1614211200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1614211200,"objectID":"07aa2289a2d0c3025ef7cf6ac0402ed6","permalink":"/post/o-manifesto-nooscope/","publishdate":"2021-02-25T00:00:00Z","relpermalink":"/post/o-manifesto-nooscope/","section":"post","summary":"Manifesto Nooscope usa alguns conceitos da fotografia, da cartograf√≠a como met√°fora para destrinchar alguns pontos pouco comentado sobre os algoritmos de Intelig√™ncia Artificial - compress√µes, sintetiza√ß√µes e distor√ß√µes.","tags":["Intelig√™ncia Artificial","pt-br"],"title":"O Manifesto Nooscope","type":"post"},{"authors":null,"categories":null,"content":"","date":1611532800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1611532800,"objectID":"f176c122df3319e489388b50266a64b0","permalink":"/post/cientista-dados-geograficos-como-cheguei-aqui/","publishdate":"2021-01-25T00:00:00Z","relpermalink":"/post/cientista-dados-geograficos-como-cheguei-aqui/","section":"post","summary":"De um processo de reflex√£o, compartilho com voc√™s a minha jornada como cientista de dados geogr√°ficos.","tags":["Autoconhecimento","Autonomia","pt-br"],"title":"Cientista de dados geogr√°ficos - Como cheguei at√© aqui?!","type":"post"},{"authors":["Felipe Sodr√© Mendes Barros"],"categories":null,"content":" Create your slides in Markdown - click the Slides button to check out the example.   Supplementary notes can be added here, including code, math, and images.\n","date":1554595200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1554595200,"objectID":"557dc08fd4b672a0c08e0a8cf0c9ff7d","permalink":"/publication/preprint/","publishdate":"2017-01-01T00:00:00Z","relpermalink":"/publication/preprint/","section":"publication","summary":"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Duis posuere tellus ac convallis placerat. Proin tincidunt magna sed ex sollicitudin condimentum.","tags":["Source Themes"],"title":"An example preprint / working paper","type":"publication"},{"authors":[],"categories":[],"content":"Create slides in Markdown with Wowchemy Wowchemy | Documentation\n Features  Efficiently write slides in Markdown 3-in-1: Create, Present, and Publish your slides Supports speaker notes Mobile friendly slides   Controls  Next: Right Arrow or Space Previous: Left Arrow Start: Home Finish: End Overview: Esc Speaker notes: S Fullscreen: F Zoom: Alt + Click PDF Export: E   Code Highlighting Inline code: variable\nCode block:\nporridge = \u0026quot;blueberry\u0026quot; if porridge == \u0026quot;blueberry\u0026quot;: print(\u0026quot;Eating...\u0026quot;)   Math In-line math: $x + y = z$\nBlock math:\n$$ f\\left( x \\right) = ;\\frac{{2\\left( {x + 4} \\right)\\left( {x - 4} \\right)}}{{\\left( {x + 4} \\right)\\left( {x + 1} \\right)}} $$\n Fragments Make content appear incrementally\n{{% fragment %}} One {{% /fragment %}} {{% fragment %}} **Two** {{% /fragment %}} {{% fragment %}} Three {{% /fragment %}}  Press Space to play!\nOne  Two  Three \n A fragment can accept two optional parameters:\n class: use a custom style (requires definition in custom CSS) weight: sets the order in which a fragment appears   Speaker Notes Add speaker notes to your presentation\n{{% speaker_note %}} - Only the speaker can read these notes - Press `S` key to view {{% /speaker_note %}}  Press the S key to view the speaker notes!\n Only the speaker can read these notes Press S key to view    Themes  black: Black background, white text, blue links (default) white: White background, black text, blue links league: Gray background, white text, blue links beige: Beige background, dark text, brown links sky: Blue background, thin dark text, blue links    night: Black background, thick white text, orange links serif: Cappuccino background, gray text, brown links simple: White background, black text, blue links solarized: Cream-colored background, dark green text, blue links   Custom Slide Customize the slide style and background\n{{\u0026lt; slide background-image=\u0026quot;/media/boards.jpg\u0026quot; \u0026gt;}} {{\u0026lt; slide background-color=\u0026quot;#0000FF\u0026quot; \u0026gt;}} {{\u0026lt; slide class=\u0026quot;my-style\u0026quot; \u0026gt;}}   Custom CSS Example Let\u0026rsquo;s make headers navy colored.\nCreate assets/css/reveal_custom.css with:\n.reveal section h1, .reveal section h2, .reveal section h3 { color: navy; }   Questions? Ask\nDocumentation\n","date":1549324800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1549324800,"objectID":"0e6de1a61aa83269ff13324f3167c1a9","permalink":"/slides/example/","publishdate":"2019-02-05T00:00:00Z","relpermalink":"/slides/example/","section":"slides","summary":"An introduction to using Wowchemy's Slides feature.","tags":[],"title":"Slides","type":"slides"},{"authors":null,"categories":null,"content":"","date":1461715200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1461715200,"objectID":"78cb99c2548e240836a010152c649104","permalink":"/project/domestic-economy/","publishdate":"2016-04-27T00:00:00Z","relpermalink":"/project/domestic-economy/","section":"project","summary":"Chatbot de telegram criado para facilitar o registro e acompanhamento de gastos dom√©sticos. Projeto criado como estrat√©gia de estudos em Python e para uso pessoal.","tags":["Chatbot","Pet project","Python"],"title":"Domestic Economy chatbot","type":"project"},{"authors":null,"categories":null,"content":"","date":1461715200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1461715200,"objectID":"056aa6241ed7f11298b10a691ea89493","permalink":"/project/restoration-priorization/","publishdate":"2016-04-27T00:00:00Z","relpermalink":"/project/restoration-priorization/","section":"project","summary":"Spatial prioritization model for forest restoration, developed in collaboration with Julia Niemeyer and Renato Crouzeilles.","tags":["Scientific project","R"],"title":"Spatial Restoration Priorization","type":"project"},{"authors":["Felipe Sodr√© Mendes Barros","Robert Ford"],"categories":null,"content":" Click the Cite button above to demo the feature to enable visitors to import publication metadata into their reference management software.    Create your slides in Markdown - click the Slides button to check out the example.   Supplementary notes can be added here, including code, math, and images.\n","date":1441065600,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1441065600,"objectID":"966884cc0d8ac9e31fab966c4534e973","permalink":"/publication/journal-article/","publishdate":"2017-01-01T00:00:00Z","relpermalink":"/publication/journal-article/","section":"publication","summary":"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Duis posuere tellus ac convallis placerat. Proin tincidunt magna sed ex sollicitudin condimentum.","tags":["Source Themes"],"title":"An example journal article","type":"publication"},{"authors":["Felipe Sodr√© Mendes Barros","Robert Ford"],"categories":null,"content":" Click the Cite button above to demo the feature to enable visitors to import publication metadata into their reference management software.    Create your slides in Markdown - click the Slides button to check out the example.   Supplementary notes can be added here, including code, math, and images.\n","date":1372636800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1372636800,"objectID":"69425fb10d4db090cfbd46854715582c","permalink":"/publication/conference-paper/","publishdate":"2017-01-01T00:00:00Z","relpermalink":"/publication/conference-paper/","section":"publication","summary":"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Duis posuere tellus ac convallis placerat. Proin tincidunt magna sed ex sollicitudin condimentum.","tags":["Source Themes"],"title":"An example conference paper","type":"publication"}]